<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Sandhills Grassland Birds – k-state_workshop</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">k-state_workshop</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../cassidy/lathrom.html"> 
<span class="menu-text">Bees Ft Riley</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../rachel/rusten.html" aria-current="page"> 
<span class="menu-text">Birds Sandhills</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#are-grassland-restoration-actions-of-woody-removal-benefiting-local-native-wildlife" id="toc-are-grassland-restoration-actions-of-woody-removal-benefiting-local-native-wildlife" class="nav-link active" data-scroll-target="#are-grassland-restoration-actions-of-woody-removal-benefiting-local-native-wildlife">Are grassland restoration actions of woody removal benefiting local native wildlife?</a></li>
  <li><a href="#becoming-acquainted-with-data" id="toc-becoming-acquainted-with-data" class="nav-link" data-scroll-target="#becoming-acquainted-with-data">Becoming acquainted with data</a>
  <ul class="collapse">
  <li><a href="#transects-within-region.label-or-group" id="toc-transects-within-region.label-or-group" class="nav-link" data-scroll-target="#transects-within-region.label-or-group">Transects within Region.Label or Group</a></li>
  <li><a href="#birds-in-flocks" id="toc-birds-in-flocks" class="nav-link" data-scroll-target="#birds-in-flocks">Birds in flocks</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis-of-detection-distances" id="toc-exploratory-data-analysis-of-detection-distances" class="nav-link" data-scroll-target="#exploratory-data-analysis-of-detection-distances">Exploratory data analysis of detection distances</a></li>
  <li><a href="#simple-analysis-for-estimates-at-the-group-level" id="toc-simple-analysis-for-estimates-at-the-group-level" class="nav-link" data-scroll-target="#simple-analysis-for-estimates-at-the-group-level">Simple analysis for estimates at the <code>Group</code> level</a></li>
  <li><a href="#constant-detectability-across-strata" id="toc-constant-detectability-across-strata" class="nav-link" data-scroll-target="#constant-detectability-across-strata">Constant detectability across strata?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Sandhills Grassland Birds</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="are-grassland-restoration-actions-of-woody-removal-benefiting-local-native-wildlife" class="level2">
<h2 class="anchored" data-anchor-id="are-grassland-restoration-actions-of-woody-removal-benefiting-local-native-wildlife">Are grassland restoration actions of woody removal benefiting local native wildlife?</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p>Goal: Evaluate the effects of Eastern Redcedar removal treatments and management on avian communities in eastern Sandhills Ecoregion in Nebraska, USA</p>
</div><div class="column" style="width:70%;">
<p><img src="studyarea.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="becoming-acquainted-with-data" class="level2">
<h2 class="anchored" data-anchor-id="becoming-acquainted-with-data">Becoming acquainted with data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>alldata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"data/Rusten_GrasslandBird_dist24.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>(numstrat <span class="ot">&lt;-</span> <span class="fu">unique</span>(alldata<span class="sc">$</span>Region.Label))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "BLA049-C"    "Dismal E"    "Double E"    "Double M"    "Double W"   
 [6] "GAR-LOWja"   "GAR-ML-A"    "GAR-PLU"     "GAR-WIL-A"   "GAR-WIL-B"  
[11] "GAR-WIL-C"   "GAR041-B"    "GAR045-A"    "GAR045-B"    "GAR046-A"   
[16] "GAR046-B"    "GAR046-C"    "GAR046-H"    "GAR046-M"    "GAR053-A"   
[21] "GAR053-B"    "GAR054"      "LOU-SMI-A"   "LOU-SMI-B"   "LOU-SMI-C"  
[26] "LOU-SWMB"    "Valentine A" "Valentine B" "Weggener"    "WHE014"     
[31] "WHE035-A"    "WHE035-B"    "WHE035-C"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(numspec <span class="ot">&lt;-</span> <span class="fu">unique</span>(alldata<span class="sc">$</span>Species))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "WEME"  "GRSP"  NA      "NOFL"  "WITU"  "BHCO"  "MODO"  "LASP"  "FISP" 
[10] "BLGR"  "CONI"  "AMCR"  "KILL"  "BARS"  "HOLA"  "RTHA"  "RHWO"  "AGOL" 
[19] "AMRO"  "BLJA"  "SPTO"  "NOCA"  "DICK"  "CLSW"  "UPSA"  "LBCO"  "NOBO" 
[28] "WEKI"  "BEVI"  "RWBL"  "HOWR"  "EAKI"  "GRCA"  "BRTH"  "CHSP"  "SOSP" 
[37] "OROR"  "NODO"  "YEWA"  "BAOR"  "COGR"  "MALL"  "BOBO"  "MODI"  "AMCK" 
[46] "MAKE"  "HCWR"  "NOFC"  "WISN"  "BWTE"  "YHBL"  "MAWR"  "NOPI"  "EUST" 
[55] "COYE"  "WIPH"  "AMBI"  "SORA"  "AMKE"  "LOSH"  "TRES"  "EUCD"  "YBCH" 
[64] "GTGR"  "WAVI"  "COHA"  "STGR"  "TUVU"  "UNSP"  "RWRL"  "REVI"  "SPTP" 
[73] "RNEP"  "EATO"  "BBHCO" "BBCH"  "NRWS"  "CANG"  "VESP"  "GRPC"  "WODU" 
[82] "RINP"  "AWPE"  "SWSP"  "BCOH"  "BAEA"  "CEWA"  "LBCU"  "GCFL"  "INBU" 
[91] "SWHA" </code></pre>
</div>
</div>
<p>Goodness, there are WEME, GRSP, NA, NOFL, WITU, BHCO, MODO, LASP, FISP, BLGR, CONI, AMCR, KILL, BARS, HOLA, RTHA, RHWO, AGOL, AMRO, BLJA, SPTO, NOCA, DICK, CLSW, UPSA, LBCO, NOBO, WEKI, BEVI, RWBL, HOWR, EAKI, GRCA, BRTH, CHSP, SOSP, OROR, NODO, YEWA, BAOR, COGR, MALL, BOBO, MODI, AMCK, MAKE, HCWR, NOFC, WISN, BWTE, YHBL, MAWR, NOPI, EUST, COYE, WIPH, AMBI, SORA, AMKE, LOSH, TRES, EUCD, YBCH, GTGR, WAVI, COHA, STGR, TUVU, UNSP, RWRL, REVI, SPTP, RNEP, EATO, BBHCO, BBCH, NRWS, CANG, VESP, GRPC, WODU, RINP, AWPE, SWSP, BCOH, BAEA, CEWA, LBCU, GCFL, INBU, SWHA species recorded during the 2024 field season. Let’s focus attention upon four species of interest: GRSP, WEME, DICK, UPSA:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fourspec <span class="ot">&lt;-</span> <span class="fu">subset</span>(alldata, <span class="at">subset =</span> Species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"GRSP"</span>, <span class="st">"WEME"</span>, <span class="st">"DICK"</span>, <span class="st">"UPSA"</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(fourspec<span class="sc">$</span>Region.Label, fourspec<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             
              DICK GRSP UPSA WEME
  BLA049-C       0   34    0   47
  Dismal E      29   47    1   48
  Double E       8   22   10   55
  Double M       2   66    0   42
  Double W      28   49    0   24
  GAR-LOWja     17   15    1    5
  GAR-ML-A      32   32    1   31
  GAR-PLU       31   24    0   25
  GAR-WIL-A     21   14    6   21
  GAR-WIL-B     13   33    0   30
  GAR-WIL-C     26   54    0   38
  GAR041-B      31   26    0   21
  GAR045-A       1   43    4   30
  GAR045-B       0   75    8   51
  GAR046-A      15   34    2   21
  GAR046-B      22   21    0   21
  GAR046-C      45   48    2   47
  GAR046-H      41   51   10   36
  GAR046-M      10   44    3   38
  GAR053-A      36   54    1   36
  GAR053-B      43   36    1   33
  GAR054        50   56    2   38
  LOU-SMI-A      7   41    3   34
  LOU-SMI-B     34   59    5   51
  LOU-SMI-C     18   43    3   29
  LOU-SWMB      52   42    0   27
  Valentine A    9   17    4   17
  Valentine B   19   12    5   20
  Weggener       0   45    2   47
  WHE014        26   28    1   37
  WHE035-A      17   22    0   18
  WHE035-B      44   58    0   49
  WHE035-C      36   21    0   30</code></pre>
</div>
</div>
<p>Detections by <code>Region.Label</code> may be a bit sparse, particularly for UPSA. Let’s see how number of detections changes if we aggregate at the level of <code>Group</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(fourspec<span class="sc">$</span>Group, fourspec<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           
            DICK GRSP UPSA WEME
  BLA049       0   34    0   47
  FS          67  229   13  216
  GAR-LOW     17   15    1    5
  GAR-ML      32   32    1   31
  GAR-WIL     60  101    6   89
  GAR041      31   26    0   21
  GAR045       1  118   12   81
  GAR046     133  198   17  163
  GAR053      79   90    2   69
  GAR054      50   56    2   38
  GARPLU      31   24    0   25
  LOU-SMI     59  143   11  114
  LOU-SW      52   42    0   27
  Valentine   28   29    9   37
  WHE014      26   28    1   37
  WHE035      97  101    0   97</code></pre>
</div>
</div>
<p>That is an improvement.</p>
<section id="transects-within-region.label-or-group" class="level3">
<h3 class="anchored" data-anchor-id="transects-within-region.label-or-group">Transects within Region.Label or Group</h3>
<p>I’m unsure about the naming scheme for points stations. It seems most sensible for transects to “belong” to strata, but the numbering system does not seem to follow that. Perhaps using <code>GridPointID</code> as <code>Sample.Label</code> makes more sense? In most instances, it seems there are 12 replicate <code>GridPointID</code> values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(fourspec<span class="sc">$</span>GridPointID[fourspec<span class="sc">$</span>Region.Label<span class="sc">==</span><span class="st">"Double W"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Double W-194" "Double W-21"  "Double W-247" "Double W-372" "Double W-385"
 [6] "Double W-427" "Double W-478" "Double W-529" "Double W-610" "Double W-764"
[11] "Double W-851" "Double W-904"</code></pre>
</div>
</div>
<p>I’ll modify the working data frame to make <code>GridPointID</code> the point transect identified <code>Sample.Label</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fourspec<span class="sc">$</span>Sample.Label <span class="ot">&lt;-</span> fourspec<span class="sc">$</span>GridPointID</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="birds-in-flocks" class="level3">
<h3 class="anchored" data-anchor-id="birds-in-flocks">Birds in flocks</h3>
<p>Is this of significance?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(fourspec<span class="sc">$</span>Species, fourspec<span class="sc">$</span>Flock)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      
          1    2    3    4    5
  DICK  746   13    4    0    0
  GRSP 1248   14    2    1    1
  UPSA   72    2    1    0    0
  WEME 1075   13    8    1    0</code></pre>
</div>
</div>
<p>Only 2.2% of dickcissel detections were of flocks &gt;1 individual, which is unlikely to alter the abundance/density estimates noticeably.</p>
<p>We will see if that makes a difference.</p>
</section>
</section>
<section id="exploratory-data-analysis-of-detection-distances" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis-of-detection-distances">Exploratory data analysis of detection distances</h2>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Distances recorded as -1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Don’t know why they exist, but they mess with detection function fitting, I’m throwing them out</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fourspec <span class="ot">&lt;-</span> <span class="fu">subset</span>(fourspec, <span class="at">subset =</span> distance<span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fourspec<span class="sc">$</span>distance[fourspec<span class="sc">$</span>Species<span class="sc">==</span><span class="st">"GRSP"</span>], </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"GRSP"</span>, <span class="at">xlab=</span><span class="st">"Radial distance"</span>, <span class="at">nc=</span><span class="dv">40</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fourspec<span class="sc">$</span>distance[fourspec<span class="sc">$</span>Species<span class="sc">==</span><span class="st">"WEME"</span>], </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"WEME"</span>, <span class="at">xlab=</span><span class="st">"Radial distance"</span>, <span class="at">nc=</span><span class="dv">40</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fourspec<span class="sc">$</span>distance[fourspec<span class="sc">$</span>Species<span class="sc">==</span><span class="st">"DICK"</span>], </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"DICK"</span>, <span class="at">xlab=</span><span class="st">"Radial distance"</span>, <span class="at">nc=</span><span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="rusten_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="rusten_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="rusten_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<p>Probably rounding of distances for meadowlark around 200 and 300m, but that shouldn’t cause problems.</p>
</section>
<section id="simple-analysis-for-estimates-at-the-group-level" class="level2">
<h2 class="anchored" data-anchor-id="simple-analysis-for-estimates-at-the-group-level">Simple analysis for estimates at the <code>Group</code> level</h2>
<p>Standard practice will be to remove 10% most distant detections.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Distance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: mrds</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is mrds 3.0.0
Built: R 4.4.1; ; 2024-10-23 19:10:34 UTC; windows</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Distance'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:mrds':

    create.bins</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>cu <span class="ot">&lt;-</span> <span class="fu">convert_units</span>(<span class="st">"meter"</span>, <span class="cn">NULL</span>, <span class="st">"hectare"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>weme <span class="ot">&lt;-</span> <span class="fu">subset</span>(fourspec, Species<span class="sc">==</span><span class="st">"WEME"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>weme.hn <span class="ot">&lt;-</span> <span class="fu">ds</span>(<span class="at">data=</span>weme, <span class="at">transect =</span> <span class="st">"point"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">key=</span><span class="st">"hn"</span>, <span class="at">truncation =</span> <span class="st">"10%"</span>,  <span class="at">convert_units =</span> cu, <span class="at">adjustment =</span> <span class="st">"herm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting AIC adjustment term selection.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting half-normal key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10176.094</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting half-normal key function with Hermite(4) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10167.679</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting half-normal key function with Hermite(4,6) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10169.671</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Half-normal key function with Hermite(4) adjustments selected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>weme.uncos <span class="ot">&lt;-</span> <span class="fu">ds</span>(<span class="at">data=</span>weme, <span class="at">transect =</span> <span class="st">"point"</span>,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">key=</span><span class="st">"unif"</span>, <span class="at">truncation =</span> <span class="st">"10%"</span>,  <span class="at">convert_units =</span> cu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting AIC adjustment term selection.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10752.837</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function with cosine(1) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10162.97</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function with cosine(1,2) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10164.74</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Uniform key function with cosine(1) adjustments selected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>weme.hr <span class="ot">&lt;-</span> <span class="fu">ds</span>(<span class="at">data=</span>weme, <span class="at">transect =</span> <span class="st">"point"</span>,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">key=</span><span class="st">"hr"</span>, <span class="at">truncation =</span> <span class="st">"10%"</span>,  <span class="at">convert_units =</span> cu, <span class="at">adjustment =</span> <span class="st">"poly"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting AIC adjustment term selection.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting hazard-rate key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10125.116</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting hazard-rate key function with simple polynomial(4) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10127.116</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Hazard-rate key function selected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize_ds_models</span>(weme.hn, weme.uncos, weme.hr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Model
3    \\texttt{weme.hr}
2 \\texttt{weme.uncos}
1    \\texttt{weme.hn}
                                                    Key function Formula
3                                                    Hazard-rate      ~1
2                 Uniform with cosine adjustment term of order 1    &lt;NA&gt;
1 Half-normal with Hermite polynomial adjustment term of order 4      ~1
  C-vM p-value $\\hat{P_a}$ se($\\hat{P_a}$) $\\Delta$AIC
3  0.044633708    0.4130381      0.017163665      0.00000
2  0.000464373    0.3489820      0.006995024     37.85356
1  0.002877489    0.4031840      0.043259167     42.56221</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(weme.hr, <span class="at">pdf=</span><span class="cn">TRUE</span>, <span class="at">nc=</span><span class="dv">40</span>, <span class="at">main=</span><span class="st">"WEME, HR, pooled detfn"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rusten_files/figure-html/weme-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>cu <span class="ot">&lt;-</span> <span class="fu">convert_units</span>(<span class="st">"meter"</span>, <span class="cn">NULL</span>, <span class="st">"hectare"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>dick <span class="ot">&lt;-</span> fourspec[fourspec<span class="sc">$</span>Species<span class="sc">==</span><span class="st">"DICK"</span>,]</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>dick.hn <span class="ot">&lt;-</span> <span class="fu">ds</span>(<span class="at">data=</span>dick, <span class="at">transect =</span> <span class="st">"point"</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">key=</span><span class="st">"hn"</span>, <span class="at">truncation =</span> <span class="st">"10%"</span>,  <span class="at">convert_units =</span> cu, <span class="at">adjustment =</span> <span class="st">"herm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting AIC adjustment term selection.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting half-normal key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 6761.816</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting half-normal key function with Hermite(4) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 6734.482</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting half-normal key function with Hermite(4,6) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 6736.481</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Half-normal key function with Hermite(4) adjustments selected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>dick.uncos <span class="ot">&lt;-</span> <span class="fu">ds</span>(<span class="at">data=</span>dick, <span class="at">transect =</span> <span class="st">"point"</span>,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">key=</span><span class="st">"unif"</span>, <span class="at">truncation =</span> <span class="st">"10%"</span>,  <span class="at">convert_units =</span> cu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting AIC adjustment term selection.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 7054.786</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function with cosine(1) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 6755.077</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function with cosine(1,2) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 6725.679</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function with cosine(1,2,3) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 6726.775</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Uniform key function with cosine(1,2) adjustments selected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>dick.hr <span class="ot">&lt;-</span> <span class="fu">ds</span>(<span class="at">data=</span>dick, <span class="at">transect =</span> <span class="st">"point"</span>,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">key=</span><span class="st">"hr"</span>, <span class="at">truncation =</span> <span class="st">"10%"</span>,  <span class="at">convert_units =</span> cu, <span class="at">adjustment =</span> <span class="st">"poly"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting AIC adjustment term selection.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting hazard-rate key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 6708.399</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting hazard-rate key function with simple polynomial(4) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 6710.399</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Hazard-rate key function selected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize_ds_models</span>(dick.hn, dick.uncos, dick.hr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Model
3    \\texttt{dick.hr}
2 \\texttt{dick.uncos}
1    \\texttt{dick.hn}
                                                    Key function Formula
3                                                    Hazard-rate      ~1
2              Uniform with cosine adjustment terms of order 1,2    &lt;NA&gt;
1 Half-normal with Hermite polynomial adjustment term of order 4      ~1
  C-vM p-value $\\hat{P_a}$ se($\\hat{P_a}$) $\\Delta$AIC
3  0.030839941    0.5151049       0.02079957      0.00000
2  0.002703775    0.4714018       0.05194985     17.28037
1  0.000541476    0.4498981       0.06111644     26.08327</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dick.hr, <span class="at">pdf=</span><span class="cn">TRUE</span>, <span class="at">nc=</span><span class="dv">40</span>, <span class="at">main=</span><span class="st">"DICK, HR, pooled detfn"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rusten_files/figure-html/dick-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>cu <span class="ot">&lt;-</span> <span class="fu">convert_units</span>(<span class="st">"meter"</span>, <span class="cn">NULL</span>, <span class="st">"hectare"</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>grsp <span class="ot">&lt;-</span> fourspec[fourspec<span class="sc">$</span>Species<span class="sc">==</span><span class="st">"GRSP"</span>,]</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>grsp.hn <span class="ot">&lt;-</span> <span class="fu">ds</span>(<span class="at">data=</span>grsp, <span class="at">transect =</span> <span class="st">"point"</span>,</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">key=</span><span class="st">"hn"</span>, <span class="at">truncation =</span> <span class="st">"10%"</span>,  <span class="at">convert_units =</span> cu, <span class="at">adjustment =</span> <span class="st">"herm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting AIC adjustment term selection.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting half-normal key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10188.996</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting half-normal key function with Hermite(4) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10191.102</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Half-normal key function selected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>grsp.uncos <span class="ot">&lt;-</span> <span class="fu">ds</span>(<span class="at">data=</span>grsp, <span class="at">transect =</span> <span class="st">"point"</span>,</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">key=</span><span class="st">"unif"</span>, <span class="at">truncation =</span> <span class="st">"10%"</span>,  <span class="at">convert_units =</span> cu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting AIC adjustment term selection.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10361.471</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function with cosine(1) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10196.275</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function with cosine(1,2) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10185.801</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting uniform key function with cosine(1,2,3) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10186.844</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Uniform key function with cosine(1,2) adjustments selected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>grsp.hr <span class="ot">&lt;-</span> <span class="fu">ds</span>(<span class="at">data=</span>grsp, <span class="at">transect =</span> <span class="st">"point"</span>,</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">key=</span><span class="st">"hr"</span>, <span class="at">truncation =</span> <span class="st">"10%"</span>,  <span class="at">convert_units =</span> cu, <span class="at">adjustment =</span> <span class="st">"poly"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Starting AIC adjustment term selection.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting hazard-rate key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10188.776</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting hazard-rate key function with simple polynomial(4) adjustments</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 10190.179</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Hazard-rate key function selected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize_ds_models</span>(grsp.hn, grsp.uncos, grsp.hr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Model                                      Key function
2 \\texttt{grsp.uncos} Uniform with cosine adjustment terms of order 1,2
3    \\texttt{grsp.hr}                                       Hazard-rate
1    \\texttt{grsp.hn}                                       Half-normal
  Formula C-vM p-value $\\hat{P_a}$ se($\\hat{P_a}$) $\\Delta$AIC
2    &lt;NA&gt;    0.2496730    0.5978375       0.05378580     0.000000
3      ~1    0.2614903    0.6271652       0.03066799     2.975003
1      ~1    0.2182570    0.5401211       0.02297043     3.194802</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grsp.uncos, <span class="at">pdf=</span><span class="cn">TRUE</span>, <span class="at">nc=</span><span class="dv">25</span>, <span class="at">main=</span><span class="st">"GRSP, unicos, pooled detfn"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rusten_files/figure-html/grsp-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="constant-detectability-across-strata" class="level2">
<h2 class="anchored" data-anchor-id="constant-detectability-across-strata">Constant detectability across strata?</h2>
<p>Clearly there are insufficient detections within strata to fit stratum-specific detection functions. However, as shown in <span class="citation" data-cites="rexstad">@rexstad</span>, bias will result from using a pooled detection function to estimate density at the stratum level <strong>if</strong> detectability differs between strata.</p>
<p>The defensible way to estimate stratum-specific detection probabilities with small stratum-specific detections is to use stratum as a covariate. This may not work for the large number of strata we have here. The hazard rate model was preferred for two of the three species and it was second-preferred for the GRSP, so attempt covariate modelling using hazard rate as key function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>weme.hrstrat <span class="ot">&lt;-</span> <span class="fu">ds</span>(<span class="at">data=</span>weme, <span class="at">transect=</span><span class="st">"point"</span>, <span class="at">key=</span><span class="st">"hr"</span>, <span class="at">truncation=</span><span class="st">"10%"</span>,</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">convert_units =</span> cu, <span class="at">formula=</span><span class="sc">~</span>Region.Label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Model contains covariate term(s): no adjustment terms will be included.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting hazard-rate key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 9756.701</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>dick.hrstrat <span class="ot">&lt;-</span> <span class="fu">ds</span>(<span class="at">data=</span>dick, <span class="at">transect=</span><span class="st">"point"</span>, <span class="at">key=</span><span class="st">"hr"</span>, <span class="at">truncation=</span><span class="st">"10%"</span>,</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">convert_units =</span> cu, <span class="at">formula=</span><span class="sc">~</span>Region.Label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Model contains covariate term(s): no adjustment terms will be included.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting hazard-rate key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 6648.044</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>grsp.hrstrat <span class="ot">&lt;-</span> <span class="fu">ds</span>(<span class="at">data=</span>grsp, <span class="at">transect=</span><span class="st">"point"</span>, <span class="at">key=</span><span class="st">"hr"</span>, <span class="at">truncation=</span><span class="st">"10%"</span>,</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">convert_units =</span> cu, <span class="at">formula=</span><span class="sc">~</span>Region.Label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Model contains covariate term(s): no adjustment terms will be included.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting hazard-rate key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 9986.936</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Convergence warning)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>There are convergence problems with the meadowlark data when using stratum as a covariate</p>
</div>
</div>
</div>
<p>Contrast models with and without Region.Label covariate for each species to provide an evidence-based assessment of constant detectability across strata.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(weme.hr, weme.hrstrat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             df       AIC
weme.hr       2 10125.116
weme.hrstrat 34  9756.701</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(dick.hr, dick.hrstrat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             df      AIC
dick.hr       2 6708.399
dick.hrstrat 31 6648.044</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(grsp.uncos, grsp.hrstrat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             df       AIC
grsp.uncos    2 10185.801
grsp.hrstrat 34  9986.936</code></pre>
</div>
</div>
<p>If you are fussy, you could use <code>BIC</code> rather than <code>AIC</code>.</p>
<p>As an experiment, use <code>Group</code> as strata and fit group as a covariate. Won’t work because <code>Area</code> specified for the grid, not group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>experiment <span class="ot">&lt;-</span> fourspec</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>experiment<span class="sc">$</span>Region.Label <span class="ot">&lt;-</span> experiment<span class="sc">$</span>Group</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>weme.group <span class="ot">&lt;-</span> <span class="fu">subset</span>(experiment, Species<span class="sc">==</span><span class="st">"WEME"</span>)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>weme.hrgroup <span class="ot">&lt;-</span> <span class="fu">ds</span>(<span class="at">data=</span>weme.group, <span class="at">transect=</span><span class="st">"point"</span>, <span class="at">key=</span><span class="st">"hr"</span>, <span class="at">truncation=</span><span class="st">"10%"</span>,</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">convert_units =</span> cu, <span class="at">formula=</span><span class="sc">~</span>Region.Label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Different idea, remove <code>Region.Label</code> for which there are fewer than 13 detections</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>weme.small <span class="ot">&lt;-</span> <span class="fu">subset</span>(weme, <span class="at">subset =</span> <span class="sc">!</span>(Region.Label <span class="sc">%in%</span> </span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"GAR-LOWja"</span>, <span class="st">"GAR046-B"</span>, <span class="st">"WHE035-A"</span>, <span class="st">"GAR041-B"</span>)))</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>weme.hrsmall <span class="ot">&lt;-</span> <span class="fu">ds</span>(<span class="at">data=</span>weme.small, <span class="at">transect=</span><span class="st">"point"</span>, <span class="at">key=</span><span class="st">"hr"</span>, <span class="at">truncation=</span><span class="st">"10%"</span>,</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">convert_units =</span> cu, <span class="at">formula=</span><span class="sc">~</span>Region.Label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Model contains covariate term(s): no adjustment terms will be included.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Fitting hazard-rate key function</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>AIC= 9103.185</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(weme.hrsmall)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Summary for distance analysis 
Number of observations :  931 
Distance range         :  0  -  190 

Model       : Hazard-rate key function 
AIC         :  9103.185 
Optimisation:  mrds (nlminb) 

Detection function parameters
Scale coefficient(s):  
                           estimate          se
(Intercept)              4.94645613    19.10393
Region.LabelDismal E    -0.09898944    18.66744
Region.LabelDouble E    -0.48019884    18.15626
Region.LabelDouble M    -0.76210390    18.40981
Region.LabelDouble W     0.16661227    18.65594
Region.LabelGAR-ML-A     0.06362141    19.01348
Region.LabelGAR-PLU     -0.35634558    18.67142
Region.LabelGAR-WIL-A    0.54371938    18.83366
Region.LabelGAR-WIL-B   -0.04968180    18.88368
Region.LabelGAR-WIL-C   -0.45769103    18.59536
Region.LabelGAR045-A     0.01274792    18.73774
Region.LabelGAR045-B    -0.66905203    18.20697
Region.LabelGAR046-A    -0.17216272    18.64758
Region.LabelGAR046-C    -0.25654444    18.59366
Region.LabelGAR046-H    -0.18178040    18.73904
Region.LabelGAR046-M     0.68830350   630.19001
Region.LabelGAR053-A    -0.36344332    18.33877
Region.LabelGAR053-B    -0.03862097    18.90256
Region.LabelGAR054      -0.28697516    18.53708
Region.LabelLOU-SMI-A    0.13299098    17.80267
Region.LabelLOU-SMI-B   -0.31331641    18.53739
Region.LabelLOU-SMI-C    0.68207774   535.96564
Region.LabelLOU-SWMB     0.16202815    19.05529
Region.LabelValentine A  0.02071491    18.89343
Region.LabelValentine B -0.45249690    18.90768
Region.LabelWeggener     0.81667827 99996.11659
Region.LabelWHE014       0.67359023   291.54242
Region.LabelWHE035-B    -0.37006710    18.65155
Region.LabelWHE035-C     0.09894224    18.70889

Shape coefficient(s):  
            estimate       se
(Intercept) 1.976874 2.685991

                        Estimate           SE       CV
Average p              0.3966269    0.5153681 1.299378
N in covered region 2347.2940803 3050.7338190 1.299681

Summary statistics:
        Region   Area CoveredArea Effort   n   k       ER     se.ER      cv.ER
1     BLA049-C  256.0   136.09379     12  41  12 3.416667 0.3361622 0.09838895
2     Dismal E  256.0   136.09379     12  41  12 3.416667 0.5143153 0.15053130
3     Double E  256.0   136.09379     12  55  12 4.583333 0.4344682 0.09479306
4     Double M  256.0   136.09379     12  42  12 3.500000 0.2302831 0.06579517
5     Double W  256.0   113.41149     10  21  10 2.100000 0.3480102 0.16571915
6     GAR-ML-A  256.0   136.09379     12  29  12 2.416667 0.2289083 0.09472066
7      GAR-PLU  170.7   102.07035      9  23   9 2.555556 0.3379313 0.13223397
8    GAR-WIL-A  256.0   124.75264     11  12  11 1.090909 0.2845905 0.26087460
9    GAR-WIL-B  256.0   136.09379     12  28  12 2.333333 0.2842676 0.12182898
10   GAR-WIL-C  256.0   124.75264     11  38  11 3.454545 0.2073046 0.06000923
11    GAR045-A  256.0   124.75264     11  30  11 2.727273 0.3835459 0.14063349
12    GAR045-B  256.0   136.09379     12  51  12 4.250000 0.2500000 0.05882353
13    GAR046-A  256.0   124.75264     11  18  11 1.636364 0.3377123 0.20637973
14    GAR046-C  256.0   136.09379     12  47  12 3.916667 0.3128155 0.07986779
15    GAR046-H  256.0   124.75264     11  34  11 3.090909 0.5633430 0.18225804
16    GAR046-M  256.0   136.09379     12  22  12 1.833333 0.3658393 0.19954870
17    GAR053-A  256.0   113.41149     10  36  10 3.600000 0.3399346 0.09442629
18    GAR053-B  234.7   124.75264     11  28  11 2.545455 0.3659020 0.14374723
19      GAR054  256.0   124.75264     11  38  11 3.454545 0.2816715 0.08153649
20   LOU-SMI-A  256.0   136.09379     12  19  12 1.583333 0.3361622 0.21231299
21   LOU-SMI-B  256.0   136.09379     12  51  12 4.250000 0.3046359 0.07167903
22   LOU-SMI-C  256.0   136.09379     12  25  12 2.083333 0.2599048 0.12475430
23    LOU-SWMB  256.0   136.09379     12  24  12 2.000000 0.2132007 0.10660036
24 Valentine A  234.7   102.07035      9  14   9 1.555556 0.2939724 0.18898224
25 Valentine B  256.0    79.38805      7  20   7 2.857143 0.3400680 0.11902381
26    Weggener  256.0   136.09379     12  42  12 3.500000 0.3793935 0.10839813
27      WHE014  256.0   136.09379     12  25  12 2.083333 0.4515685 0.21675290
28    WHE035-B  256.0   136.09379     12  49  12 4.083333 0.4680445 0.11462314
29    WHE035-C  256.0   113.41149     10  28  10 2.800000 0.4422166 0.15793451
30       Total 7296.1  3674.53243    324 931 324 2.860505 0.0656242 0.02294147

Abundance:
         Label   Estimate          se         cv         lcl         ucl
1     BLA049-C  118.70857 3747.133492 31.5658208   0.6834632 20618.11867
2     Dismal E  141.02344   54.120928  0.3837726  68.0218614   292.37086
3     Double E  392.41228  437.190491  1.1141101  67.3052378  2287.89615
4     Double M  524.51942  298.034709  0.5682053 185.7442420  1481.17979
5     Double W   57.02110   34.300390  0.6015385  19.1461301   169.82053
6     GAR-ML-A   75.80229   11.678692  0.1540678  55.8671455   102.85092
7      GAR-PLU  114.42073   27.074128  0.2366191  71.8995417   182.08885
8    GAR-WIL-A   24.62775    6.430165  0.2610942  13.9007784    43.63254
9    GAR-WIL-B   88.24475   15.492283  0.1755604  62.1508306   125.29416
10   GAR-WIL-C  282.93188   78.196441  0.2763790 166.1112264   481.90873
11    GAR045-A   92.77601   35.380134  0.3813500  44.9535667   191.47284
12    GAR045-B  529.15165  516.567280  0.9762178 106.2281804  2635.84926
13    GAR046-A   77.24652   31.214837  0.4040937  35.7964323   166.69329
14    GAR046-C  216.86782   80.178125  0.3697096 107.4177437   437.83877
15    GAR046-H  148.55496   37.527077  0.2526141  89.7295974   245.94533
16    GAR046-M   41.38322    8.257970  0.1995487  26.7879517    63.93065
17    GAR053-A  245.09655  196.384075  0.8012519  61.5331668   976.25921
18    GAR053-B   86.57913   16.743650  0.1933913  58.6149799   127.88446
19      GAR054  202.78577   92.998388  0.4586041  86.0264628   478.01648
20   LOU-SMI-A   44.90801   77.911017  1.7349023   4.4451332   453.69388
21   LOU-SMI-B  262.49555  115.070902  0.4383728 115.2836182   597.69041
22   LOU-SMI-C   47.02639    5.866750  0.1247544  35.7727323    61.82031
23    LOU-SWMB   54.61721    9.377702  0.1716987  38.8823884    76.71957
24 Valentine A   47.88484   13.491204  0.2817427  27.3788029    83.74940
25 Valentine B  231.62251   95.508723  0.4123465 106.3214327   504.59242
26    Weggener   79.00434    8.563922  0.1083981  62.2785148   100.22213
27      WHE014   47.02639   10.193113  0.2167530  29.3444692    75.36280
28    WHE035-B  281.61922   64.253698  0.2281581 180.4733019   439.45219
29    WHE035-C   83.30214   42.283326  0.5075899  32.5195162   213.38712
30       Total 4639.66046 5763.759465  1.2422804 696.6133049 30901.57626
          df
1  901.01750
2  339.38371
3  910.22380
4  911.86115
5  629.79354
6   74.53056
7   78.63421
8   10.03372
9   46.77287
10 813.03999
11 373.40631
12 906.59250
13 134.95262
14 828.70885
15  36.56062
16  11.00000
17 908.51692
18  32.52362
19 876.62339
20 911.35019
21 895.81087
22  11.00004
23  71.80487
24  39.00233
25 478.55139
26  11.00000
27  11.00003
28 155.97391
29 513.67071
30 901.55203

Density:
         Label   Estimate          se         cv         lcl        ucl
1     BLA049-C 0.46370536 14.63724020 31.5658208 0.002669778 80.5395260
2     Dismal E 0.55087281  0.21140988  0.3837726 0.265710396  1.1420737
3     Double E 1.53286045  1.70777536  1.1141101 0.262911085  8.9370943
4     Double M 2.04890397  1.16419808  0.5682053 0.725563445  5.7858586
5     Double W 0.22273868  0.13398590  0.6015385 0.074789571  0.6633615
6     GAR-ML-A 0.29610269  0.04561989  0.1540678 0.218231037  0.4017614
7      GAR-PLU 0.67030307  0.15860649  0.2366191 0.421204111  1.0667185
8    GAR-WIL-A 0.09620217  0.02511783  0.2610942 0.054299916  0.1704396
9    GAR-WIL-B 0.34470605  0.06051673  0.1755604 0.242776682  0.4894303
10   GAR-WIL-C 1.10520266  0.30545485  0.2763790 0.648871978  1.8824560
11    GAR045-A 0.36240627  0.13820365  0.3813500 0.175599870  0.7479408
12    GAR045-B 2.06699864  2.01784094  0.9762178 0.414953830 10.2962862
13    GAR046-A 0.30174423  0.12193296  0.4040937 0.139829814  0.6511457
14    GAR046-C 0.84713994  0.31319580  0.3697096 0.419600561  1.7103077
15    GAR046-H 0.58029280  0.14659015  0.2526141 0.350506240  0.9607239
16    GAR046-M 0.16165322  0.03225769  0.1995487 0.104640436  0.2497291
17    GAR053-A 0.95740842  0.76712529  0.8012519 0.240363933  3.8135126
18    GAR053-B 0.36889274  0.07134065  0.1933913 0.249744269  0.5448848
19      GAR054 0.79213190  0.36327495  0.4586041 0.336040870  1.8672519
20   LOU-SMI-A 0.17542193  0.30433991  1.7349023 0.017363802  1.7722417
21   LOU-SMI-B 1.02537323  0.44949571  0.4383728 0.450326633  2.3347281
22   LOU-SMI-C 0.18369684  0.02291699  0.1247544 0.139737235  0.2414856
23    LOU-SWMB 0.21334849  0.03663165  0.1716987 0.151884330  0.2996858
24 Valentine A 0.20402575  0.05748276  0.2817427 0.116654465  0.3568359
25 Valentine B 0.90477545  0.37308095  0.4123465 0.415318096  1.9710641
26    Weggener 0.30861069  0.03345282  0.1083981 0.243275448  0.3914927
27      WHE014 0.18369684  0.03981685  0.2167530 0.114626833  0.2943860
28    WHE035-B 1.10007509  0.25099101  0.2281581 0.704973835  1.7166101
29    WHE035-C 0.32539897  0.16516924  0.5075899 0.127029360  0.8335434
30       Total 0.63590966  0.78997813  1.2422804 0.095477489  4.2353554
          df
1  901.01750
2  339.38371
3  910.22380
4  911.86115
5  629.79354
6   74.53056
7   78.63421
8   10.03372
9   46.77287
10 813.03999
11 373.40631
12 906.59250
13 134.95262
14 828.70885
15  36.56062
16  11.00000
17 908.51692
18  32.52362
19 876.62339
20 911.35019
21 895.81087
22  11.00004
23  71.80487
24  39.00233
25 478.55139
26  11.00000
27  11.00003
28 155.97391
29 513.67071
30 901.55203</code></pre>
</div>
</div>
<p>The convergence may still not be perfect; however the CVs at the stratum level are reasonable, staying below 0.35.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(weme.hrsmall, <span class="at">pdf=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>rlabels <span class="ot">&lt;-</span> <span class="fu">unique</span>(weme.small<span class="sc">$</span>Region.Label)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rlabels)) {</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_df_covar_line</span>(weme.hrsmall, <span class="at">data=</span><span class="fu">data.frame</span>(<span class="at">Region.Label=</span>rlabels[i]),</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">pdf=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="fu">colours</span>(<span class="cn">TRUE</span>)[i])</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">title=</span><span class="st">"Strata"</span>, <span class="at">legend=</span>rlabels,</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">colours</span>(<span class="cn">TRUE</span>), <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rusten_files/figure-html/unnamed-chunk-16-1.png" width="672" height="600" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The plot of the probability density functions at the stratum level indicates one stratum with a <em>very</em> different detection function shape compared to the rest of the strata (WHE014). This may explain the convergence challenge. That stratum might be a candidate for exclusion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(weme<span class="sc">$</span>distance[weme<span class="sc">$</span>Region.Label<span class="sc">==</span><span class="st">"WHE014"</span>], <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">190</span>), <span class="at">nc=</span><span class="dv">10</span>,</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Radial distance"</span>, <span class="at">main=</span><span class="st">"Stratum WHE014 detections of WEME"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rusten_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note the SE of the stratum-<span class="math inline">\(\hat{\beta}\)</span> associated with stratum <code>WHE014</code> 291.5424185</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>