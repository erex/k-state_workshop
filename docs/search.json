[
  {
    "objectID": "rachel/rusten_grids.html",
    "href": "rachel/rusten_grids.html",
    "title": "Sandhills Grassland Birds groups as strata üê¶",
    "section": "",
    "text": "Second analysis of grassland birds\n\n\n\n\n\n\nAlternative definition of strata\n\nPreviously 33 strata were defined\n\nThis analysis uses ‚Äúgroup‚Äù as the stratification criterion\n\nResulting in 19 strata, with a resulting increase in number of detections underpinning the 19 estimates of density",
    "crumbs": [
      "Sandhill birds üê¶",
      "Sandhills Grassland Birds groups as strata  üê¶"
    ]
  },
  {
    "objectID": "rachel/rusten_grids.html#transects-within-strata",
    "href": "rachel/rusten_grids.html#transects-within-strata",
    "title": "Sandhills Grassland Birds groups as strata üê¶",
    "section": "1.1 Transects within strata",
    "text": "1.1 Transects within strata\nThe revised data has placed transect labels in the field Sample.Label where the labels should be. This is a departure from the previous data set when the transect labels resided in a (now removed) field GridPointID. That makes life easier, as there is no field renaming to perform.\nProblems can arise when subsetting the data, with concomitant loss of information about the survey design. The inclusion of a record for each point transect (using NA for species and distance) maintains the integrity of the design within the flatfile. The next code chunk creates a sample table that encapsulates the design information such that the data can be subset (by species for example), while having the survey design information available during the analysis.\n\nGroupArea &lt;- mat.or.vec(length(namstrat),1)\nj &lt;- 0\nfor (i in namstrat) {\n  j &lt;- j+1\n  GroupArea[j] &lt;- unique(alldata[alldata$Region.Label==i, \"Area\"])\n}\nregionTable &lt;- data.frame(Region.Label=namstrat, Area=GroupArea)\n\nnumtran &lt;- mat.or.vec(length(namstrat),1)\nnamtran &lt;- list()\nj &lt;- 0\nfor (i in namstrat) {\n  j &lt;- j+1\n  numtran[j] &lt;- length(unique(alldata[alldata$Region.Label==i, \"Sample.Label\"]))\n  namtran[[j]] &lt;- unique(alldata[alldata$Region.Label==i, \"Sample.Label\"])\n#  print(paste(i, numtran[j], sep=\" \"))\n}\nrepeatGroups &lt;- c(rep(namstrat[1], numtran[1]),\n                  rep(namstrat[2], numtran[2]),\n                  rep(namstrat[3], numtran[3]),\n                  rep(namstrat[4], numtran[4]),\n                  rep(namstrat[5], numtran[5]),\n                  rep(namstrat[6], numtran[6]),\n                  rep(namstrat[7], numtran[7]),\n                  rep(namstrat[8], numtran[8]),\n                  rep(namstrat[9], numtran[9]),\n                  rep(namstrat[10], numtran[10]),\n                  rep(namstrat[11], numtran[11]),\n                  rep(namstrat[12], numtran[12]),\n                  rep(namstrat[13], numtran[13]),\n                  rep(namstrat[14], numtran[14]),\n                  rep(namstrat[15], numtran[15]),\n                  rep(namstrat[16], numtran[16]),\n                  rep(namstrat[17], numtran[17]),\n                  rep(namstrat[18], numtran[18]),\n                  rep(namstrat[19], numtran[19]))\npointStations &lt;- c(namtran, recursive=TRUE)\nsampleTable &lt;- data.frame(Sample.Label=pointStations,\n                          Region.Label=repeatGroups,\n                          Effort=1)\n\n\n\n\n\n\n\nDistances recorded as -1\n\n\n\n\n\nDon‚Äôt know why they exist, but they mess with detection function fitting, I‚Äôm throwing them out\n\n\n\n\nalldata &lt;- subset(alldata, subset = distance&gt; -1)\n\nWith data wrangling complete, we can begin our model fitting. I do not repeat the histogram of detection distances by common species, as they can be seen in the previous report.",
    "crumbs": [
      "Sandhill birds üê¶",
      "Sandhills Grassland Birds groups as strata  üê¶"
    ]
  },
  {
    "objectID": "natalie/pegg.html",
    "href": "natalie/pegg.html",
    "title": "Mourning doves üïäÔ∏è",
    "section": "",
    "text": "Study Locations\n\nTopeka (east)\nMcPherson (central)\nGarden City (west)\n\nTreatments include \n\nWMAs (wildlife managed areas)\nurban (developed)\nrural\n\n\n\n\n\nMap of Kansas",
    "crumbs": [
      "Mourning doves üïäÔ∏è"
    ]
  },
  {
    "objectID": "cassidy/lathrom.html",
    "href": "cassidy/lathrom.html",
    "title": "Ft Riley bumblebees üêù",
    "section": "",
    "text": "evaluate environmental factors affecting bumblebee density and abundance using distance sampling methods\n\n\n\n\n\n\n\nMultiple years of data, my approach\n\n\n\n\n\nThere are three years of survey data. The first year (2022) was described as a pilot survey, so I will not thoroughly examine the 2022 data.",
    "crumbs": [
      "Bees Ft Riley üêù"
    ]
  },
  {
    "objectID": "cassidy/lathrom.html#objective",
    "href": "cassidy/lathrom.html#objective",
    "title": "Ft Riley bumblebees üêù",
    "section": "",
    "text": "evaluate environmental factors affecting bumblebee density and abundance using distance sampling methods\n\n\n\n\n\n\n\nMultiple years of data, my approach\n\n\n\n\n\nThere are three years of survey data. The first year (2022) was described as a pilot survey, so I will not thoroughly examine the 2022 data.",
    "crumbs": [
      "Bees Ft Riley üêù"
    ]
  },
  {
    "objectID": "cassidy/lathrom.html#data-organisation-complete-fit-some-models",
    "href": "cassidy/lathrom.html#data-organisation-complete-fit-some-models",
    "title": "Ft Riley bumblebees üêù",
    "section": "3.1 Data organisation complete, fit some models",
    "text": "3.1 Data organisation complete, fit some models\nA glance at the histograms produced earlier suggests an abrupt drop in detection probability around 5-8m, suggesting the flexibility of the hazard rate model will be useful, but we fit the full series of candidates to each bout. Note too the existence of a small number of detections at great distances, they will not be very useful in our detection function modelling. We are likely to be more aggressive in our truncation than we might otherwise be when dealing with non-insect species.\n\nlibrary(Distance)\ncu &lt;- convert_units(\"meter\", \"meter\", \"hectare\")\nbbunicos &lt;- ds(data=bb_bees_b1, key=\"unif\", adj=\"cos\", convert_units = cu,\n               region_table = bb_reg_tab1, sample_table = bb_sam_tab1,\n               truncation = \"10%\")\nbbhnherm &lt;- ds(data=bb_bees_b1, key=\"hn\", adj=\"herm\", convert_units = cu,\n               region_table = bb_reg_tab1, sample_table = bb_sam_tab1,\n               truncation = \"10%\")\nbbhrsim &lt;- ds(data=bb_bees_b1, key=\"hr\", adj=\"poly\", convert_units = cu,\n               region_table = bb_reg_tab1, sample_table = bb_sam_tab1,\n               truncation = \"10%\")\nknitr::kable(summarize_ds_models(bbunicos, bbhnherm, bbhrsim)[, c(2:7)],\n             digits=3, row.names=FALSE,\n             caption=\"Model criticism candidate model set\\n brown_belted bout 1\")\n\n\nModel criticism candidate model set brown_belted bout 1\n\n\n\n\n\n\n\n\n\n\nKey function\nFormula\nC-vM p-value\n\\(\\hat{P_a}\\)\nse(\\(\\hat{P_a}\\))\n\\(\\Delta\\)AIC\n\n\n\n\nUniform with cosine adjustment terms of order 1,2\nNA\n0.769\n0.446\n0.030\n0.000\n\n\nHazard-rate\n~1\n0.859\n0.444\n0.044\n0.312\n\n\nHalf-normal\n~1\n0.307\n0.477\n0.026\n0.831\n\n\n\n\n\nDouble-check that we have the right number of transects:\n\nknitr::kable(bbunicos$dht$individuals$summary)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRegion\nArea\nCoveredArea\nEffort\nn\nk\nER\nse.ER\ncv.ER\n\n\n\n\nFRMR\n28383\n551.7512\n75500\n160\n151\n0.0021192\n0.0003848\n0.1815787\n\n\n\n\n\n\n\n\n\n\n\nWhat did we learn from this?\n\n\n\n\n\n\nall models fit the data\n\\(\\Delta\\)AIC among candidates is small\nNot by coincidence, \\(\\hat{P}_a\\) are very similar across models\n\n\n\n\nBefore examining the density estimate, continue for sampling bout 2\n\nlibrary(Distance)\ncu &lt;- convert_units(\"meter\", \"meter\", \"hectare\")\nbbunicos2 &lt;- ds(data=bb_bees_b2, key=\"unif\", adj=\"cos\", convert_units = cu,\n               region_table = bb_reg_tab2, sample_table = bb_sam_tab2,\n               truncation = \"10%\")\nbbhnherm2 &lt;- ds(data=bb_bees_b2, key=\"hn\", adj=\"herm\", convert_units = cu,\n               region_table = bb_reg_tab2, sample_table = bb_sam_tab2,\n               truncation = \"10%\")\nbbhrsim2 &lt;- ds(data=bb_bees_b2, key=\"hr\", adj=\"poly\", convert_units = cu,\n               region_table = bb_reg_tab2, sample_table = bb_sam_tab2,\n               truncation = \"10%\")\nknitr::kable(summarize_ds_models(bbunicos2, bbhnherm2, bbhrsim2)[, c(2:7)],\n             digits=3, row.names=FALSE,\n             caption=\"Model criticism candidate model set\\n brown_belted bout 2\")\n\n\nModel criticism candidate model set brown_belted bout 2\n\n\n\n\n\n\n\n\n\n\nKey function\nFormula\nC-vM p-value\n\\(\\hat{P_a}\\)\nse(\\(\\hat{P_a}\\))\n\\(\\Delta\\)AIC\n\n\n\n\nHazard-rate\n~1\n0.712\n0.236\n0.025\n0.000\n\n\nUniform with cosine adjustment terms of order 1,2,3,4,5\nNA\n0.643\n0.227\n0.016\n5.307\n\n\nHalf-normal\n~1\n0.000\n0.358\n0.014\n42.282\n\n\n\n\n\nThe difference in \\(\\Delta\\)AIC among candidates is greater for bout 2, and you will see a bit more disparity between \\(\\hat{P}_a\\), particularly the non-fitting half normal model.\nLet‚Äôs look at the fit of the selected models for each bout:\nplot(bbunicos, nc=20, main=\"brown_belted, bout 1, unifcos\")\nplot(bbhrsim2, nc=20, main=\"brown_belted, bout 2, hazard rate\")\n\n\n\n\n\n\n\n\n\n\nLooking at the plots, I think I would truncate yet more aggressively again; to ~30m.\n\nbbunicosx &lt;- ds(data=bb_bees_b1, key=\"unif\", adj=\"cos\", convert_units = cu,\n               region_table = bb_reg_tab1, sample_table = bb_sam_tab1,\n               truncation = 31)\nbbhnhermx &lt;- ds(data=bb_bees_b1, key=\"hn\", adj=\"herm\", convert_units = cu,\n               region_table = bb_reg_tab1, sample_table = bb_sam_tab1,\n               truncation = 31)\nbbhrsimx &lt;- ds(data=bb_bees_b1, key=\"hr\", adj=\"poly\", convert_units = cu,\n               region_table = bb_reg_tab1, sample_table = bb_sam_tab1,\n               truncation = 31)\nbbunicos2x &lt;- ds(data=bb_bees_b2, key=\"unif\", adj=\"cos\", convert_units = cu,\n               region_table = bb_reg_tab2, sample_table = bb_sam_tab2,\n               truncation = 31)\nbbhnherm2x &lt;- ds(data=bb_bees_b2, key=\"hn\", adj=\"herm\", convert_units = cu,\n               region_table = bb_reg_tab2, sample_table = bb_sam_tab2,\n               truncation = 31)\nbbhrsim2x &lt;- ds(data=bb_bees_b2, key=\"hr\", adj=\"poly\", convert_units = cu,\n               region_table = bb_reg_tab2, sample_table = bb_sam_tab2,\n               truncation = 31)\nknitr::kable(summarize_ds_models(bbunicosx, bbhnhermx, bbhrsimx)[, c(2:7)],\n             digits=3, row.names=FALSE,\n             caption=\"Model criticism candidate model set\\n brown_belted bout 1 trunc=31\")\n\n\nModel criticism candidate model set brown_belted bout 1 trunc=31\n\n\n\n\n\n\n\n\n\n\nKey function\nFormula\nC-vM p-value\n\\(\\hat{P_a}\\)\nse(\\(\\hat{P_a}\\))\n\\(\\Delta\\)AIC\n\n\n\n\nUniform with cosine adjustment terms of order 1,2\nNA\n0.929\n0.487\n0.039\n0.000\n\n\nHalf-normal\n~1\n0.470\n0.532\n0.032\n0.277\n\n\nHazard-rate\n~1\n0.900\n0.495\n0.054\n0.609\n\n\n\n\nknitr::kable(summarize_ds_models(bbunicos2x, bbhnherm2x, bbhrsim2x)[, c(2:7)],\n             digits=3, row.names=FALSE,\n             caption=\"Model criticism candidate model set\\n brown_belted bout 2 trunc=31\")\n\n\nModel criticism candidate model set brown_belted bout 2 trunc=31\n\n\n\n\n\n\n\n\n\n\nKey function\nFormula\nC-vM p-value\n\\(\\hat{P_a}\\)\nse(\\(\\hat{P_a}\\))\n\\(\\Delta\\)AIC\n\n\n\n\nHazard-rate\n~1\n0.691\n0.431\n0.044\n0.000\n\n\nUniform with cosine adjustment terms of order 1,2,3\nNA\n0.358\n0.375\n0.032\n2.995\n\n\nHalf-normal\n~1\n0.093\n0.473\n0.025\n7.611\n\n\n\n\n\nplot(bbunicosx, nc=20, main=\"brown_belted, bout 1, unifcos, trunc=31\")\nplot(bbhrsim2x, nc=20, main=\"brown_belted, bout 2, hazard rate, trunc=31\")",
    "crumbs": [
      "Bees Ft Riley üêù"
    ]
  },
  {
    "objectID": "cassidy/lathrom.html#did-truncation-changes-influence-estimated-density",
    "href": "cassidy/lathrom.html#did-truncation-changes-influence-estimated-density",
    "title": "Ft Riley bumblebees üêù",
    "section": "3.2 Did truncation changes influence estimated density?",
    "text": "3.2 Did truncation changes influence estimated density?\nWe have seen there is no change in the models selected when changing the truncation distance, how about the estimates?\n\nbb1_10 &lt;- bbunicos$dht$individuals$D\nbb2_10 &lt;- bbhrsim$dht$individuals$D\nbb1_31 &lt;- bbunicosx$dht$individuals$D\nbb2_31 &lt;- bbhrsimx$dht$individuals$D\nestimates &lt;- rbind(bb1_10, bb1_31, bb2_10, bb2_31)\nestimates$Label &lt;- c(\"Bout1 10%\", \"Bout1 31m\", \"Bout2 10%\", \"Bout2 31m\")\nknitr::kable(estimates, digits=3,\n             caption=\"Estimates for brown belted, both bouts, different truncation distances\")\n\n\nEstimates for brown belted, both bouts, different truncation distances\n\n\nLabel\nEstimate\nse\ncv\nlcl\nucl\ndf\n\n\n\n\nBout1 10%\n0.651\n0.126\n0.193\n0.446\n0.950\n190.066\n\n\nBout1 31m\n0.684\n0.138\n0.201\n0.462\n1.013\n203.897\n\n\nBout2 10%\n0.653\n0.135\n0.206\n0.436\n0.976\n231.548\n\n\nBout2 31m\n0.673\n0.144\n0.214\n0.443\n1.022\n243.124\n\n\n\n\n\nWe see roughly a 3-5% difference in the point estimates from the more aggressive truncation. Place that difference in the context of the coefficient of variation (~20%).\n\nWe could continue to carry out this species by species, bout by bout analysis for the common species. However, eventually problems will arise when get to species like AMER_BG, black_gold, bombus, etc. If estimates for those species x bout combinations are important, we will have to ‚Äúborrow strength‚Äù from other species to produce robust estimates for those rare species.\nWe ‚Äúborrow strength‚Äù via the use of species and sampling bout as covariates in the detection function. I ignore other potential covariates, e.g.¬†observer, because the property of pooling robustness ensures that bias is not introduced by ignoring such covariates.",
    "crumbs": [
      "Bees Ft Riley üêù"
    ]
  },
  {
    "objectID": "cassidy/lathrom.html#construct-region-table-and-sample-tables",
    "href": "cassidy/lathrom.html#construct-region-table-and-sample-tables",
    "title": "Ft Riley bumblebees üêù",
    "section": "4.1 Construct region table and sample tables",
    "text": "4.1 Construct region table and sample tables\n\n\n\n\n\n\nThe following step is critical\n\n\n\n\n\n\nIf the following specification of the survey design is not followed, the analysis will issue no complaints and will produce density estimates that appear to be quite wonderful.\nHowever, they will be wrong.\nBecause the stratum redefinition destroys the information about the survey design.\nInstead, the software assumes there were only transects on which detections of the species x bout combinations were made.\nAlways check the summary output from your fitted models to make sure the correct number of transects are represented.\n\n\n\n\n\nyr24$Region.Label &lt;- paste0(yr24$species, yr24$sample.bout)\nnew_region_table &lt;- data.frame(Region.Label=unique(yr24$Region.Label),\n                               Area=28383)\nnew_sample_table &lt;- data.frame(Sample.Label=rep(seq(1,151), 19),\n                               Region.Label=rep(unique(yr24$Region.Label), 151),\n                               Effort=rep(500, 19*151))\n\n\n#yr24$Region.Label &lt;- paste0(yr24$species, yr24$sample.bout)\nyr24_hn_2level &lt;- ds(yr24, key=\"hn\", truncation = \"10%\", convert_units = cu,\n                     region_table = new_region_table,\n                     sample_table = new_sample_table,\n                     formula=~species+as.factor(sample.bout))\nyr24_hr_2level &lt;- ds(yr24, key=\"hr\", truncation = \"10%\", convert_units = cu,\n                     region_table = new_region_table,\n                     sample_table = new_sample_table,\n                     formula=~species+as.factor(sample.bout))\nyr24_hn_species &lt;- ds(yr24, key=\"hn\", truncation = \"10%\", convert_units = cu,\n                     region_table = new_region_table,\n                     sample_table = new_sample_table,\n                     formula=~species)\nyr24_hr_species &lt;- ds(yr24, key=\"hr\", truncation = \"10%\", convert_units = cu,\n                     region_table = new_region_table,\n                     sample_table = new_sample_table,\n                     formula=~species)\nyr24_hn_bout &lt;- ds(yr24, key=\"hn\", truncation = \"10%\", convert_units = cu,\n                     region_table = new_region_table,\n                     sample_table = new_sample_table,\n                     formula=~as.factor(sample.bout))\nyr24_hr_bout &lt;- ds(yr24, key=\"hr\", truncation = \"10%\", convert_units = cu,\n                     region_table = new_region_table,\n                     sample_table = new_sample_table,\n                     formula=~as.factor(sample.bout))\nyr24_hn &lt;- ds(yr24, key=\"hn\", truncation = \"10%\", convert_units = cu,\n                     region_table = new_region_table,\n                     sample_table = new_sample_table)\nyr24_hr &lt;- ds(yr24, key=\"hr\", truncation = \"10%\", convert_units = cu,\n                     region_table = new_region_table,\n                     sample_table = new_sample_table)\nknitr::kable(summarize_ds_models(#yr24_hn, yr24_hr, \n                    yr24_hn_bout, yr24_hr_bout, \n                    yr24_hn_species, yr24_hr_species, \n                    yr24_hn_2level, yr24_hr_2level)[, c(2:7)],\n             digits=3, row.names=FALSE,\n             caption=\"Model criticism candidate model set 2024\")\n\n\nModel criticism candidate model set 2024\n\n\n\n\n\n\n\n\n\n\nKey function\nFormula\nC-vM p-value\n\\(\\hat{P_a}\\)\nse(\\(\\hat{P_a}\\))\n\\(\\Delta\\)AIC\n\n\n\n\nHazard-rate\n~species + as.factor(sample.bout)\n0.854\n0.338\n0.014\n0.000\n\n\nHazard-rate\n~species\n0.831\n0.335\n0.014\n2.851\n\n\nHazard-rate\n~as.factor(sample.bout)\n0.955\n0.344\n0.014\n6.120\n\n\nHalf-normal\n~species + as.factor(sample.bout)\n0.000\n0.427\n0.008\n84.245\n\n\nHalf-normal\n~as.factor(sample.bout)\n0.000\n0.431\n0.008\n86.072\n\n\nHalf-normal\n~species\n0.000\n0.429\n0.008\n90.691\n\n\n\n\nknitr::kable(summary(yr24_hr_2level$ddf)$coeff$key.scale, \n             caption=\"Looking for convergence problems in covariate coefficients\")\n\n\nLooking for convergence problems in covariate coefficients\n\n\n\nestimate\nse\n\n\n\n\n(Intercept)\n2.3163705\n0.1768905\n\n\nspeciesamerican\n-0.1288956\n0.1958475\n\n\nspeciesblack_gold\n0.3598236\n0.2640821\n\n\nspeciesbombus\n0.2680591\n0.3690617\n\n\nspeciesbrown_belted\n0.0099796\n0.1846799\n\n\nspeciescarpenter\n-0.4039568\n0.1873527\n\n\nspecieseastern\n-0.0423246\n0.3281912\n\n\nspeciessouthern_plains\n0.0507996\n0.2260533\n\n\nspeciestwsp\n-0.1139367\n0.4077639\n\n\nspeciesunk\n-0.4962881\n0.2450548\n\n\nas.factor(sample.bout)2\n-0.2066934\n0.0939350",
    "crumbs": [
      "Bees Ft Riley üêù"
    ]
  },
  {
    "objectID": "cassidy/lathrom.html#given-the-preferred-model-is-ok-look-at-the-plot",
    "href": "cassidy/lathrom.html#given-the-preferred-model-is-ok-look-at-the-plot",
    "title": "Ft Riley bumblebees üêù",
    "section": "4.2 Given the preferred model is OK, look at the plot",
    "text": "4.2 Given the preferred model is OK, look at the plot\n\nplot(yr24_hr_2level, nc=39)\nsp &lt;- unique(yr24$species)\nbo &lt;- unique(yr24$sample.bout)\npalette(\"ggplot2\")\nfor (i in 1:length(sp)) {\n  for (j in 1:length(bo))\n  add_df_covar_line(yr24_hr_2level, \n                    data=data.frame(species=sp[i], sample.bout=bo[j]),\n                    lwd=2, lty=1, col=rainbow(19)[i])\n}\nlegend(\"topright\", title=\"Spec x bout\", legend=unique(yr24$Region.Label),\n       lwd=2, lty=1, col=rainbow(19), cex=0.8)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSpecies and bout-specific detection probability estimates\n\n\n\n\n\nAlthough the figure is pretty, we cannot deduce the species x bout-specific detection probabilities. Assuming these estimates are of interest, how do we produce them, given the software won‚Äôt cooperate with our request. Answer integrate detection function over distance for specific covariate levels.\n\n\n\nBelow is a function that will calculate detection probability for a given set of estimated covariate coefficients at a given perpendicular distance. We will use the function, in conjunction with the coefficients for a species and bout combination of interest.\n\ngz&lt;-function(z,\n             beta, sigintercept, sigcoef, DistWin=FALSE,\n             key=\"HR\", w=max(z)){\n#this is a generic detection function that returns the probability of detecting an animal\n#    z               generic distance (perpendicular) - can be scalar or vector\n#    beta            shape coefficient\n#    sigintercept  intercept coefficient for sigma\n#    sigcoef         coefficient for specific factor level\n#    DistWin         coefficients from Distance for Windows or from R\n#    key             the detection function key, works for hazard rate and half normal\n#    w               truncation distance, by default the max of the distances\n#\n#RETURNS: a probability\n  \n  if(key != \"HN\" & key != \"HR\") {\n    stop(\"Argument 'key' must be either HN or HR\")\n  }\n  if (DistWin) {\n    sigma &lt;- sigintercept + exp(sigcoef)\n    exponent &lt;- beta\n  } else {\n    numterms &lt;- length(sigcoef)\n    predictor &lt;- 0\n    for (i in 1:numterms) {\n      predictor &lt;- predictor + sigcoef[i]\n    }\n    sigma &lt;- exp(sigintercept + predictor)\n    exponent &lt;- exp(beta)\n  }\n  if(key==\"HR\") {\n    scale.dist &lt;- z/sigma\n    inside &lt;- -(scale.dist)^(-exponent)\n    gx &lt;- 1 - exp(inside)\n  } else {\n    scale.dist &lt;- z  # debatably don't scale for half normal\n    inside &lt;- -(scale.dist^2/(2*sigma^2))\n    gx &lt;- exp(inside)\n  }\n  return(gx)\n}",
    "crumbs": [
      "Bees Ft Riley üêù"
    ]
  },
  {
    "objectID": "cassidy/lathrom.html#apply-function-to-the-selected-yr24_hr_2level-model",
    "href": "cassidy/lathrom.html#apply-function-to-the-selected-yr24_hr_2level-model",
    "title": "Ft Riley bumblebees üêù",
    "section": "4.3 Apply function to the selected yr24_hr_2level model",
    "text": "4.3 Apply function to the selected yr24_hr_2level model\nCode below plucks out the relevant estimated coefficients from our model that included species and bout as covariates. I demonstrate only for two species and the two bouts. Code then plots the derived detection function from the fitted covariate coefficients. This gives us a sense check whether we‚Äôve picked up the coefficients correctly.\n\ncoefs &lt;- yr24_hr_2level$ddf$par\nxmax &lt;- unname(yr24_hr_2level$ddf$meta.data$width)\nxvals &lt;- seq(0,xmax, length=100)\nam1 &lt;- gz(z=xvals, key=\"HR\",beta=coefs[\"V1\"], sigintercept = coefs[\"X.Intercept.\"], \n          sigcoef = c(coefs[\"speciesamerican\"]))\nam2 &lt;- gz(z=xvals, key=\"HR\",beta=coefs[\"V1\"], sigintercept = coefs[\"X.Intercept.\"], \n          sigcoef = c(coefs[\"speciesamerican\"], coefs[\"as.factor.sample.bout.2\"]))\nbomb1 &lt;- gz(z=xvals, key=\"HR\",beta=coefs[\"V1\"], sigintercept = coefs[\"X.Intercept.\"], \n          sigcoef = c(coefs[\"speciesbombus\"]))\nbomb2 &lt;- gz(z=xvals, key=\"HR\",beta=coefs[\"V1\"], sigintercept = coefs[\"X.Intercept.\"], \n          sigcoef = c(coefs[\"speciesbombus\"], coefs[\"as.factor.sample.bout.2\"]))\nplot(xvals, am1, lwd=2, type=\"l\",\n     main=\"Construct species x bout detection functions manually\",\n     xlab=\"Distance\", ylab=\"Detection probability\")\nlines(xvals, am2, lwd=2, col=\"blue\")\nlines(xvals, bomb1, lwd=2, col=\"darkgreen\")\nlines(xvals, bomb2, lwd=2, col=\"red\")\nlegend(\"topright\", legend=c(\"American1\", \"American2\", \"Bombus1\", \"Bombus2\"),\n       col=c(\"black\",\"blue\",\"darkgreen\",\"red\"), lwd=2)",
    "crumbs": [
      "Bees Ft Riley üêù"
    ]
  },
  {
    "objectID": "cassidy/lathrom.html#integration-and-conversion-to-detection-probability",
    "href": "cassidy/lathrom.html#integration-and-conversion-to-detection-probability",
    "title": "Ft Riley bumblebees üêù",
    "section": "4.4 Integration and conversion to detection probability",
    "text": "4.4 Integration and conversion to detection probability\nSense check completed, we now use our gz function to ‚Äúmanually‚Äù compute species- and bout-specific detection probabilities for the for examples created above. The formula being applied here (see Lecture 2 of notes) is \\(\\hat{P}_a\\) is ‚Äúarea under curve‚Äù divided by ‚Äúarea of rectangle‚Äù\n\\[\\hat{P}_a=\\frac{\\int^w_0 \\hat{g}(x) dx}{w} \\]\n\nam1_p_int &lt;- integrate(gz, lower=0, upper=xmax, key=\"HR\",\n                    beta=coefs[\"V1\"], sigintercept = coefs[\"X.Intercept.\"], \n                    sigcoef = c(coefs[\"speciesamerican\"]))$value / xmax\nam2_p_int &lt;- integrate(gz, lower=0, upper=xmax, key=\"HR\",\n                    beta=coefs[\"V1\"], sigintercept = coefs[\"X.Intercept.\"], \n                    sigcoef = c(coefs[\"speciesamerican\"], coefs[\"as.factor.sample.bout.2\"]))$value / xmax\nbomb1_p_int &lt;- integrate(gz, lower=0, upper=xmax, key=\"HR\",\n                    beta=coefs[\"V1\"], sigintercept = coefs[\"X.Intercept.\"], \n                    sigcoef = c(coefs[\"speciesbombus\"]))$value / xmax\nbomb2_p_int &lt;- integrate(gz, lower=0, upper=xmax, key=\"HR\",\n                    beta=coefs[\"V1\"], sigintercept = coefs[\"X.Intercept.\"], \n                    sigcoef = c(coefs[\"speciesbombus\"], coefs[\"as.factor.sample.bout.2\"]))$value / xmax\n\n\n\n\n\n\n\nAn easier way to compute \\(\\hat{P}_a\\)\n\n\n\n\n\n\nThere exists a function in the mrds package called detfct that duplicates the job of gz\nyour hands do not get quite so dirty when using detfct\nI will demonstrate the use of detfct to calculate \\(\\hat{P}_a\\) for American bees in bouts 1 and 2\n\nKey to using detfct is determining the combination of covariates in your data for which you wish to compute \\(\\hat{P}_a\\). We use the which command applied to the design matrix created by ds and located in an obscure place within the dsmodel object.\n\nfindam1 &lt;- which(yr24_hr_2level$ddf$ds$aux$ddfobj$xmat$species==\"american\" &\n                 yr24_hr_2level$ddf$ds$aux$ddfobj$xmat$sample.bout==1)[1]\nfindam2 &lt;- which(yr24_hr_2level$ddf$ds$aux$ddfobj$xmat$species==\"american\" &\n                 yr24_hr_2level$ddf$ds$aux$ddfobj$xmat$sample.bout==2)[1]\nfindbomb1 &lt;- which(yr24_hr_2level$ddf$ds$aux$ddfobj$xmat$species==\"bombus\" &\n                   yr24_hr_2level$ddf$ds$aux$ddfobj$xmat$sample.bout==1)[1]\nfindbomb2 &lt;- which(yr24_hr_2level$ddf$ds$aux$ddfobj$xmat$species==\"bombus\" &\n                   yr24_hr_2level$ddf$ds$aux$ddfobj$xmat$sample.bout==2)[1]\n\nHaving found the proper index values, these can be passed to the detfct function which serves the same purpose as the gz function I created earlier. Note, the detfct function is called by the integrate function to compute the area under the fitted detection function. The integral (\\(\\hat{\\mu}\\)) is divided by the truncation distance \\(w\\) to arrive at estimates of detection probability for the four species X bout combinations.\n\nam1_pdetfct &lt;- integrate(f=detfct, lower=0, upper=xmax,\n                         ddfobj=yr24_hr_2level$ddf$ds$aux$ddfobj,\n                         index=findam1)$value/xmax\nam2_pdetfct &lt;- integrate(f=detfct, lower=0, upper=xmax,\n                         ddfobj=yr24_hr_2level$ddf$ds$aux$ddfobj,\n                         index=findam2)$value/xmax\nbomb1_pdetfct &lt;- integrate(f=detfct, lower=0, upper=xmax,\n                           ddfobj=yr24_hr_2level$ddf$ds$aux$ddfobj,\n                           index=findbomb1)$value/xmax\nbomb2_pdetfct &lt;- integrate(f=detfct, lower=0, upper=xmax,\n                           ddfobj=yr24_hr_2level$ddf$ds$aux$ddfobj,\n                           index=findbomb2)$value/xmax\n\nWith the estimates of \\(\\hat{P}_a\\) computed using detfct, we can compare them to the estimates we produced using the gz function.\n\ncompare &lt;- data.frame(gz_values=c(am1_p_int, am2_p_int, bomb1_p_int, bomb2_p_int),\n                      detfct_val=c(am1_pdetfct, am2_pdetfct, bomb1_pdetfct, bomb2_pdetfct))\nknitr::kable(compare, digits=4, caption=\"Estimates of $\\\\hat{P}_a$ computed using `gz` function and `detfct` function.\")\n\n\nEstimates of \\(\\hat{P}_a\\) computed using gz function and detfct function.\n\n\ngz_values\ndetfct_val\n\n\n\n\n0.3675\n0.3675\n\n\n0.3088\n0.3088\n\n\n0.5023\n0.5023\n\n\n0.4286\n0.4286\n\n\n\n\n\nYes, the two methods are equivalent. Now back to our original analysis.",
    "crumbs": [
      "Bees Ft Riley üêù"
    ]
  },
  {
    "objectID": "cassidy/lathrom.html#do-the-integrated-pa-correspond-to-reported-densities",
    "href": "cassidy/lathrom.html#do-the-integrated-pa-correspond-to-reported-densities",
    "title": "Ft Riley bumblebees üêù",
    "section": "4.5 Do the integrated Pa correspond to reported densities?",
    "text": "4.5 Do the integrated Pa correspond to reported densities?\nRecall our formula to estimate density:\n\\[\\hat{D} = \\frac{\\hat{P}_a \\cdot n}{a}\\] where \\(n\\) is number of detections and \\(a\\) is covered area. Both of these quantities appear in the fitted model object, along with \\(\\hat{D}\\) for each species x bout combination.\nWe can rearrange the above formula to solve for \\(\\hat{P}_a\\):\n\\[\\hat{P}_a = \\frac{n}{\\hat{D} \\cdot a}\\] The following code chunk carries out this method of deriving \\(\\hat{P}_a\\) and compares them with the original method of computing the integral of the detection function and dividing by truncation distance, \\(w\\).\n\nsumm &lt;- yr24_hr_2level$dht$individuals$summary\ncoveredarea &lt;- yr24_hr_2level$dht$individuals$summary$CoveredArea[1]\nd_est &lt;- yr24_hr_2level$dht$individuals$D\n\nam1_p_data &lt;- summ[summ$Region==\"american1\", \"n\"] / (d_est[d_est$Label==\"american1\", \"Estimate\"] * coveredarea)\nam2_p_data &lt;- summ[summ$Region==\"american2\", \"n\"] / (d_est[d_est$Label==\"american2\", \"Estimate\"] * coveredarea)\nbomb1_p_data &lt;- summ[summ$Region==\"bombus1\", \"n\"] / (d_est[d_est$Label==\"bombus1\", \"Estimate\"] * coveredarea)\nbomb2_p_data &lt;- summ[summ$Region==\"bombus2\", \"n\"] / (d_est[d_est$Label==\"bombus2\", \"Estimate\"] * coveredarea)\n\nall.equal(am1_p_int, am1_p_data)\n\n[1] \"Mean relative difference: 1.076724e-06\"\n\nall.equal(am2_p_int, am2_p_data)\n\n[1] \"Mean relative difference: 3.448128e-08\"\n\nall.equal(bomb1_p_int, bomb1_p_data)\n\n[1] \"Mean relative difference: 2.311959e-06\"\n\nall.equal(bomb2_p_int, bomb2_p_data)\n\n[1] \"Mean relative difference: 4.616678e-07\"\n\n\nYes, the integration results in a \\(\\hat{P}_a\\) equivalent to that used in the estimates produced by the software (as if there was any doubt).\nNow that the detection probability estimate dilemma is sorted, let‚Äôs look at the objects of ecological interest, namely the species- and bout-specific density estimates.",
    "crumbs": [
      "Bees Ft Riley üêù"
    ]
  },
  {
    "objectID": "cassidy/lathrom.html#compare-estimates-from-basic-analysis",
    "href": "cassidy/lathrom.html#compare-estimates-from-basic-analysis",
    "title": "Ft Riley bumblebees üêù",
    "section": "5.1 Compare estimates from ‚Äúbasic‚Äù analysis",
    "text": "5.1 Compare estimates from ‚Äúbasic‚Äù analysis\nRemember we started the modelling of the 2024 data by looking at the ‚Äúbrown_belted‚Äù species in Section¬†3. In that analysis, each sampling bout for that species was modelled in isolation, as there were sufficient numbers of detections of that species in each bout.\nAfter choosing the most appropriate models from that pair of analyses, density estimates were\n\nknitr::kable(estimates[c(1,3),], digits=2, caption=\"Estimated brown belted densities from 'standalone' analysis\")\n\n\nEstimated brown belted densities from ‚Äòstandalone‚Äô analysis\n\n\n\nLabel\nEstimate\nse\ncv\nlcl\nucl\ndf\n\n\n\n\n1\nBout1 10%\n0.65\n0.13\n0.19\n0.45\n0.95\n190.07\n\n\n3\nBout2 10%\n0.65\n0.13\n0.21\n0.44\n0.98\n231.55\n\n\n\n\n\nCompare these point and interval estimates to those generated from our 2-level stratification model:\n\nbb1cov &lt;- yr24_hr_2level$dht$individuals$D[yr24_hr_2level$dht$individuals$D$Label==\"brown_belted1\", ]\nbb2cov &lt;- yr24_hr_2level$dht$individuals$D[yr24_hr_2level$dht$individuals$D$Label==\"brown_belted2\", ]\nknitr::kable(rbind(bb1cov, bb2cov)[,1:6], digits=3,\n             caption=\"Density estimates brown belted from HR covariate model\")\n\n\nDensity estimates brown belted from HR covariate model\n\n\n\nLabel\nEstimate\nse\ncv\nlcl\nucl\n\n\n\n\n9\nbrown_belted1\n0.676\n0.134\n0.198\n0.459\n0.995\n\n\n10\nbrown_belted2\n0.805\n0.167\n0.208\n0.537\n1.207\n\n\n\n\n\nThere is some difference in the point estimate for sampling bout 2; however the confidence intervals for the estimates from the two modelling approaches are quite similar. With reasonable data, which these are, the estimates are often robust to decisions made during analysis.",
    "crumbs": [
      "Bees Ft Riley üêù"
    ]
  },
  {
    "objectID": "cassidy/lathrom.html#magical-estimates-for-rare-species",
    "href": "cassidy/lathrom.html#magical-estimates-for-rare-species",
    "title": "Ft Riley bumblebees üêù",
    "section": "6.1 Magical estimates for rare species?",
    "text": "6.1 Magical estimates for rare species?\nDensity estimates are produced for all species in the data frame Table¬†1; even for species with as few as four detections (eastern2). Is that some kind of magic? No, look closely at the measures of precision associated with the species with small numbers of detection:\n\nlibrary(kableExtra)\nknitr::kable(table.attr=\"quarto-disable-processing=true\",\n             format=\"html\",\n             yr24_hr_2level$dht$individuals$D[, 1:6],\n             row.names = FALSE, digits=3) %&gt;%\n  row_spec(c(5:8,13:14,17), background = \"salmon\") %&gt;%\n  row_spec(c(18:20), strikeout=TRUE) %&gt;%\n  column_spec(c(2:6), width=\"4em\")\n\n\n \n  \n    Label \n    Estimate \n    se \n    cv \n    lcl \n    ucl \n  \n \n\n  \n    AMER_BG1 \n    0.193 \n    0.046 \n    0.237 \n    0.122 \n    0.306 \n  \n  \n    AMER_BG2 \n    0.164 \n    0.047 \n    0.286 \n    0.095 \n    0.286 \n  \n  \n    american1 \n    0.369 \n    0.071 \n    0.191 \n    0.254 \n    0.536 \n  \n  \n    american2 \n    0.556 \n    0.123 \n    0.221 \n    0.361 \n    0.854 \n  \n  \n    black_gold1 \n    0.070 \n    0.024 \n    0.342 \n    0.037 \n    0.135 \n  \n  \n    black_gold2 \n    0.112 \n    0.038 \n    0.337 \n    0.059 \n    0.213 \n  \n  \n    bombus1 \n    0.065 \n    0.024 \n    0.374 \n    0.032 \n    0.132 \n  \n  \n    bombus2 \n    0.020 \n    0.010 \n    0.517 \n    0.008 \n    0.052 \n  \n  \n    brown_belted1 \n    0.676 \n    0.134 \n    0.198 \n    0.459 \n    0.995 \n  \n  \n    brown_belted2 \n    0.805 \n    0.167 \n    0.208 \n    0.537 \n    1.207 \n  \n  \n    carpenter1 \n    1.126 \n    0.175 \n    0.155 \n    0.831 \n    1.525 \n  \n  \n    carpenter2 \n    0.551 \n    0.108 \n    0.196 \n    0.376 \n    0.808 \n  \n  \n    eastern1 \n    0.109 \n    0.039 \n    0.358 \n    0.055 \n    0.215 \n  \n  \n    eastern2 \n    0.010 \n    0.008 \n    0.748 \n    0.003 \n    0.038 \n  \n  \n    southern_plains1 \n    0.230 \n    0.058 \n    0.252 \n    0.141 \n    0.375 \n  \n  \n    southern_plains2 \n    0.196 \n    0.063 \n    0.321 \n    0.106 \n    0.363 \n  \n  \n    twsp1 \n    0.060 \n    0.032 \n    0.532 \n    0.022 \n    0.160 \n  \n  \n    unk1 \n    0.300 \n    0.073 \n    0.244 \n    0.187 \n    0.482 \n  \n  \n    unk2 \n    0.107 \n    0.035 \n    0.327 \n    0.057 \n    0.201 \n  \n  \n    Total \n    0.301 \n    0.021 \n    0.070 \n    0.263 \n    0.345 \n  \n\n\n\n\n\nEven though density estimates were produces for these species x bout combinations, their precision would suggest the estimates are not terribly reliable. It is comforting that the imprecision of these estimates is consistent with the small number of detections, even if there is some ‚Äúborrowing of strength‚Äù from other species. This use of covariates may help in the modelling of the detection function, but remember the role that encounter rates and their variability plays in density estimation.",
    "crumbs": [
      "Bees Ft Riley üêù"
    ]
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "What is on this website?",
    "section": "",
    "text": "Material on this website is intended to be used during the December 2024 workshop as ‚Äúcase studies‚Äù. Three researchers provided me with some of their field data and supporting information.\nI‚Äôve examined those data sets and with some back-and-forth with the researchers, have performed some distance sampling analyses. The analyses are not intended to be definitive; nor are they intended to be elegant.\nI have included essentially everything I did and presented the analysis in the order in which I conducted it. This includes blind alleys I travelled. Hopefully I have provided narrative to compliment the analyses so readers can understand the rationale for the steps and the interpretation of the findings.",
    "crumbs": [
      "What is on this website?"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Kansas State workshop",
    "section": "",
    "text": "Distance sampling of several data sets\nThese are not intended to be complete analyses, but rather the initial steps in a thorough analysis of such data."
  },
  {
    "objectID": "rachel/rusten.html",
    "href": "rachel/rusten.html",
    "title": "Sandhills Grassland Birds grid as strata üê¶",
    "section": "",
    "text": "Goal: Evaluate the effects of Eastern Redcedar removal treatments and management on avian communities in eastern Sandhills Ecoregion in Nebraska, USA\n\n\n\n\n\n\n\n\n\n\nBefore beginning, a note about point transects\n\n\n\n\n\n\nAnimal movement can bias distance sampling estimates\nBias is magnified when animals move faster than observers\nObservers are stationary during point counts\nSee Buckland (2006) regarding ‚Äúsnapshot moment‚Äù to alleviate bias",
    "crumbs": [
      "Sandhill birds üê¶",
      "Sandhills Grassland Birds grid as strata üê¶"
    ]
  },
  {
    "objectID": "rachel/rusten.html#are-grassland-restoration-actions-of-woody-removal-benefiting-local-native-wildlife",
    "href": "rachel/rusten.html#are-grassland-restoration-actions-of-woody-removal-benefiting-local-native-wildlife",
    "title": "Sandhills Grassland Birds grid as strata üê¶",
    "section": "",
    "text": "Goal: Evaluate the effects of Eastern Redcedar removal treatments and management on avian communities in eastern Sandhills Ecoregion in Nebraska, USA\n\n\n\n\n\n\n\n\n\n\nBefore beginning, a note about point transects\n\n\n\n\n\n\nAnimal movement can bias distance sampling estimates\nBias is magnified when animals move faster than observers\nObservers are stationary during point counts\nSee Buckland (2006) regarding ‚Äúsnapshot moment‚Äù to alleviate bias",
    "crumbs": [
      "Sandhill birds üê¶",
      "Sandhills Grassland Birds grid as strata üê¶"
    ]
  },
  {
    "objectID": "rachel/rusten.html#becoming-acquainted-with-data",
    "href": "rachel/rusten.html#becoming-acquainted-with-data",
    "title": "Sandhills Grassland Birds grid as strata üê¶",
    "section": "2 Becoming acquainted with data",
    "text": "2 Becoming acquainted with data\n\nalldata &lt;- read.csv(file=\"data/Rusten_GrasslandBird_dist24.csv\")\n(numstrat &lt;- unique(alldata$Region.Label))\n\n [1] \"BLA049-C\"    \"Dismal E\"    \"Double E\"    \"Double M\"    \"Double W\"   \n [6] \"GAR-LOWja\"   \"GAR-ML-A\"    \"GAR-PLU\"     \"GAR-WIL-A\"   \"GAR-WIL-B\"  \n[11] \"GAR-WIL-C\"   \"GAR041-B\"    \"GAR045-A\"    \"GAR045-B\"    \"GAR046-A\"   \n[16] \"GAR046-B\"    \"GAR046-C\"    \"GAR046-H\"    \"GAR046-M\"    \"GAR053-A\"   \n[21] \"GAR053-B\"    \"GAR054\"      \"LOU-SMI-A\"   \"LOU-SMI-B\"   \"LOU-SMI-C\"  \n[26] \"LOU-SWMB\"    \"Valentine A\" \"Valentine B\" \"Weggener\"    \"WHE014\"     \n[31] \"WHE035-A\"    \"WHE035-B\"    \"WHE035-C\"   \n\n(numspec &lt;- unique(alldata$Species))\n\n [1] \"WEME\"  \"GRSP\"  NA      \"NOFL\"  \"WITU\"  \"BHCO\"  \"MODO\"  \"LASP\"  \"FISP\" \n[10] \"BLGR\"  \"CONI\"  \"AMCR\"  \"KILL\"  \"BARS\"  \"HOLA\"  \"RTHA\"  \"RHWO\"  \"AGOL\" \n[19] \"AMRO\"  \"BLJA\"  \"SPTO\"  \"NOCA\"  \"DICK\"  \"CLSW\"  \"UPSA\"  \"LBCO\"  \"NOBO\" \n[28] \"WEKI\"  \"BEVI\"  \"RWBL\"  \"HOWR\"  \"EAKI\"  \"GRCA\"  \"BRTH\"  \"CHSP\"  \"SOSP\" \n[37] \"OROR\"  \"NODO\"  \"YEWA\"  \"BAOR\"  \"COGR\"  \"MALL\"  \"BOBO\"  \"MODI\"  \"AMCK\" \n[46] \"MAKE\"  \"HCWR\"  \"NOFC\"  \"WISN\"  \"BWTE\"  \"YHBL\"  \"MAWR\"  \"NOPI\"  \"EUST\" \n[55] \"COYE\"  \"WIPH\"  \"AMBI\"  \"SORA\"  \"AMKE\"  \"LOSH\"  \"TRES\"  \"EUCD\"  \"YBCH\" \n[64] \"GTGR\"  \"WAVI\"  \"COHA\"  \"STGR\"  \"TUVU\"  \"UNSP\"  \"RWRL\"  \"REVI\"  \"SPTP\" \n[73] \"RNEP\"  \"EATO\"  \"BBHCO\" \"BBCH\"  \"NRWS\"  \"CANG\"  \"VESP\"  \"GRPC\"  \"WODU\" \n[82] \"RINP\"  \"AWPE\"  \"SWSP\"  \"BCOH\"  \"BAEA\"  \"CEWA\"  \"LBCU\"  \"GCFL\"  \"INBU\" \n[91] \"SWHA\" \n\n\nGoodness, there are 91 species recorded during the 2024 field season. Let‚Äôs focus attention upon four species of interest: GRSP, WEME, DICK, UPSA:\n\nfourspec &lt;- subset(alldata, subset = Species %in% c(\"GRSP\", \"WEME\", \"DICK\", \"UPSA\"))\ntable(fourspec$Region.Label, fourspec$Species)\n\n             \n              DICK GRSP UPSA WEME\n  BLA049-C       0   34    0   47\n  Dismal E      29   47    1   48\n  Double E       8   22   10   55\n  Double M       2   66    0   42\n  Double W      28   49    0   24\n  GAR-LOWja     17   15    1    5\n  GAR-ML-A      32   32    1   31\n  GAR-PLU       31   24    0   25\n  GAR-WIL-A     21   14    6   21\n  GAR-WIL-B     13   33    0   30\n  GAR-WIL-C     26   54    0   38\n  GAR041-B      31   26    0   21\n  GAR045-A       1   43    4   30\n  GAR045-B       0   75    8   51\n  GAR046-A      15   34    2   21\n  GAR046-B      22   21    0   21\n  GAR046-C      45   48    2   47\n  GAR046-H      41   51   10   36\n  GAR046-M      10   44    3   38\n  GAR053-A      36   54    1   36\n  GAR053-B      43   36    1   33\n  GAR054        50   56    2   38\n  LOU-SMI-A      7   41    3   34\n  LOU-SMI-B     34   59    5   51\n  LOU-SMI-C     18   43    3   29\n  LOU-SWMB      52   42    0   27\n  Valentine A    9   17    4   17\n  Valentine B   19   12    5   20\n  Weggener       0   45    2   47\n  WHE014        26   28    1   37\n  WHE035-A      17   22    0   18\n  WHE035-B      44   58    0   49\n  WHE035-C      36   21    0   30\n\n\nDetections by Region.Label may be a bit sparse, particularly for UPSA. Let‚Äôs see how number of detections changes if we aggregate at the level of Group.\n\ntable(fourspec$Group, fourspec$Species)\n\n           \n            DICK GRSP UPSA WEME\n  BLA049       0   34    0   47\n  FS          67  229   13  216\n  GAR-LOW     17   15    1    5\n  GAR-ML      32   32    1   31\n  GAR-WIL     60  101    6   89\n  GAR041      31   26    0   21\n  GAR045       1  118   12   81\n  GAR046     133  198   17  163\n  GAR053      79   90    2   69\n  GAR054      50   56    2   38\n  GARPLU      31   24    0   25\n  LOU-SMI     59  143   11  114\n  LOU-SW      52   42    0   27\n  Valentine   28   29    9   37\n  WHE014      26   28    1   37\n  WHE035      97  101    0   97\n\n\nThat is an improvement.\n\n2.1 Transects within Region.Label or Group\nI‚Äôm unsure about the naming scheme for points stations. It seems most sensible for transects to ‚Äúbelong‚Äù to strata, but the numbering system does not seem to follow that. Perhaps using GridPointID as Sample.Label makes more sense? In most instances, it seems there are 12 replicate GridPointID values.\n\nunique(fourspec$GridPointID[fourspec$Region.Label==\"Double W\"])\n\n [1] \"Double W-194\" \"Double W-21\"  \"Double W-247\" \"Double W-372\" \"Double W-385\"\n [6] \"Double W-427\" \"Double W-478\" \"Double W-529\" \"Double W-610\" \"Double W-764\"\n[11] \"Double W-851\" \"Double W-904\"\n\n\nI‚Äôll modify the working data frame to make GridPointID the point transect identified Sample.Label.\n\nfourspec$Sample.Label &lt;- fourspec$GridPointID\n\n\n\n2.2 Birds in flocks\nIs this of significance?\n\ntable(fourspec$Species, fourspec$Flock)\n\n      \n          1    2    3    4    5\n  DICK  746   13    4    0    0\n  GRSP 1248   14    2    1    1\n  UPSA   72    2    1    0    0\n  WEME 1075   13    8    1    0\n\n\nOnly 2.2% of dickcissel detections were of flocks &gt;1 individual, which is unlikely to alter the abundance/density estimates noticeably.\nWe will see if that makes a difference.",
    "crumbs": [
      "Sandhill birds üê¶",
      "Sandhills Grassland Birds grid as strata üê¶"
    ]
  },
  {
    "objectID": "rachel/rusten.html#exploratory-data-analysis-of-detection-distances",
    "href": "rachel/rusten.html#exploratory-data-analysis-of-detection-distances",
    "title": "Sandhills Grassland Birds grid as strata üê¶",
    "section": "3 Exploratory data analysis of detection distances",
    "text": "3 Exploratory data analysis of detection distances\n\n\n\n\n\n\nDistances recorded as -1\n\n\n\n\n\nDon‚Äôt know why they exist, but they mess with detection function fitting, I‚Äôm throwing them out\n\n\n\n\nfourspec &lt;- subset(fourspec, subset = distance&gt; -1)\n\nhist(fourspec$distance[fourspec$Species==\"GRSP\"], \n     main=\"GRSP\", xlab=\"Radial distance\", nc=40)\nhist(fourspec$distance[fourspec$Species==\"WEME\"], \n     main=\"WEME\", xlab=\"Radial distance\", nc=40)\nhist(fourspec$distance[fourspec$Species==\"DICK\"], \n     main=\"DICK\", xlab=\"Radial distance\", nc=40)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nProbably rounding of distances for meadowlark around 200 and 300m, but that shouldn‚Äôt cause problems.",
    "crumbs": [
      "Sandhill birds üê¶",
      "Sandhills Grassland Birds grid as strata üê¶"
    ]
  },
  {
    "objectID": "rachel/rusten.html#simple-analysis-for-estimates-at-the-group-level",
    "href": "rachel/rusten.html#simple-analysis-for-estimates-at-the-group-level",
    "title": "Sandhills Grassland Birds grid as strata üê¶",
    "section": "4 Simple analysis for estimates at the Group level",
    "text": "4 Simple analysis for estimates at the Group level\nStandard practice will be to remove 10% most distant detections.\n\nlibrary(Distance)\n\nLoading required package: mrds\n\n\nThis is mrds 3.0.0\nBuilt: R 4.4.1; ; 2024-10-23 19:10:34 UTC; windows\n\n\n\nAttaching package: 'Distance'\n\n\nThe following object is masked from 'package:mrds':\n\n    create.bins\n\ncu &lt;- convert_units(\"meter\", NULL, \"hectare\")\nweme &lt;- subset(fourspec, Species==\"WEME\")\nweme.hn &lt;- ds(data=weme, transect = \"point\",\n         key=\"hn\", truncation = \"10%\",  convert_units = cu, adjustment = \"herm\")\n\nStarting AIC adjustment term selection.\n\n\nFitting half-normal key function\n\n\nAIC= 10176.094\n\n\nFitting half-normal key function with Hermite(4) adjustments\n\n\nAIC= 10167.679\n\n\nFitting half-normal key function with Hermite(4,6) adjustments\n\n\nWarning in check.mono(result, n.pts = control$mono.points): Detection function\nis greater than 1 at some distances\n\n\nAIC= 10169.671\n\n\n\nHalf-normal key function with Hermite(4) adjustments selected.\n\nweme.uncos &lt;- ds(data=weme, transect = \"point\",\n         key=\"unif\", truncation = \"10%\",  convert_units = cu)\n\nStarting AIC adjustment term selection.\n\n\nFitting uniform key function\n\n\nAIC= 10752.837\n\n\nFitting uniform key function with cosine(1) adjustments\n\n\nAIC= 10162.97\n\n\nFitting uniform key function with cosine(1,2) adjustments\n\n\nAIC= 10164.74\n\n\n\nUniform key function with cosine(1) adjustments selected.\n\nweme.hr &lt;- ds(data=weme, transect = \"point\",\n         key=\"hr\", truncation = \"10%\",  convert_units = cu, adjustment = \"poly\")\n\nStarting AIC adjustment term selection.\n\n\nFitting hazard-rate key function\n\n\nAIC= 10125.116\n\n\nFitting hazard-rate key function with simple polynomial(4) adjustments\n\n\nAIC= 10127.116\n\n\n\nHazard-rate key function selected.\n\nsummarize_ds_models(weme.hn, weme.uncos, weme.hr)\n\n                 Model\n3    \\\\texttt{weme.hr}\n2 \\\\texttt{weme.uncos}\n1    \\\\texttt{weme.hn}\n                                                    Key function Formula\n3                                                    Hazard-rate      ~1\n2                 Uniform with cosine adjustment term of order 1    &lt;NA&gt;\n1 Half-normal with Hermite polynomial adjustment term of order 4      ~1\n  C-vM p-value $\\\\hat{P_a}$ se($\\\\hat{P_a}$) $\\\\Delta$AIC\n3 0.0446337078    0.4130381      0.017163665      0.00000\n2 0.0004631091    0.3490043      0.006997644     37.85355\n1 0.0028774891    0.4031840      0.043259167     42.56221\n\nplot(weme.hr, pdf=TRUE, nc=40, main=\"WEME, HR, pooled detfn\")\n\n\n\n\n\n\n\n\n\ncu &lt;- convert_units(\"meter\", NULL, \"hectare\")\ndick &lt;- fourspec[fourspec$Species==\"DICK\",]\ndick.hn &lt;- ds(data=dick, transect = \"point\",\n         key=\"hn\", truncation = \"10%\",  convert_units = cu, adjustment = \"herm\")\n\nStarting AIC adjustment term selection.\n\n\nFitting half-normal key function\n\n\nAIC= 6761.816\n\n\nFitting half-normal key function with Hermite(4) adjustments\n\n\nAIC= 6734.482\n\n\nFitting half-normal key function with Hermite(4,6) adjustments\n\n\nWarning in check.mono(result, n.pts = control$mono.points): Detection function\nis greater than 1 at some distances\nWarning in check.mono(result, n.pts = control$mono.points): Detection function\nis greater than 1 at some distances\n\n\nAIC= 6735.127\n\n\n\nHalf-normal key function with Hermite(4) adjustments selected.\n\ndick.uncos &lt;- ds(data=dick, transect = \"point\",\n         key=\"unif\", truncation = \"10%\",  convert_units = cu)\n\nStarting AIC adjustment term selection.\n\n\nFitting uniform key function\n\n\nAIC= 7054.786\n\n\nFitting uniform key function with cosine(1) adjustments\n\n\nAIC= 6755.077\n\n\nFitting uniform key function with cosine(1,2) adjustments\n\n\nWarning in check.mono(result, n.pts = control$mono.points): Detection function\nis greater than 1 at some distances\nWarning in check.mono(result, n.pts = control$mono.points): Detection function\nis greater than 1 at some distances\n\n\nAIC= 6725.678\n\n\nFitting uniform key function with cosine(1,2,3) adjustments\n\n\n** Warning: Maximum probability of detection is greater than one: invalid model fitted **\n** Warning: Maximum probability of detection is greater than one: invalid model fitted **\n** Warning: Maximum probability of detection is greater than one: invalid model fitted **\n\n\nWarning in check.mono(result, n.pts = control$mono.points): Detection function\nis not weakly monotonic!\n\n\nWarning in check.mono(result, n.pts = control$mono.points): Detection function\nis not strictly monotonic!\n\n\nWarning in check.mono(result, n.pts = control$mono.points): Detection function\nis greater than 1 at some distances\n\n\nWarning in check.mono(result, n.pts = control$mono.points): Detection function\nis not weakly monotonic!\n\n\nWarning in check.mono(result, n.pts = control$mono.points): Detection function\nis not strictly monotonic!\n\n\nWarning in check.mono(result, n.pts = control$mono.points): Detection function\nis greater than 1 at some distances\n\n\nAIC= 6723.171\n\n\nFitting uniform key function with cosine(1,2,3,4) adjustments\n\n\nWarning in check.mono(result, n.pts = control$mono.points): Detection function\nis not strictly monotonic!\n\n\nWarning in check.mono(result, n.pts = control$mono.points): Detection function\nis not strictly monotonic!\n\n\nAIC= 6715.747\n\n\nFitting uniform key function with cosine(1,2,3,4,5) adjustments\n\n\nWarning in check.mono(result, n.pts = control$mono.points): Detection function\nis not strictly monotonic!\nWarning in check.mono(result, n.pts = control$mono.points): Detection function\nis not strictly monotonic!\n\n\nAIC= 6716.003\n\n\n\nUniform key function with cosine(1,2,3,4) adjustments selected.\n\n\nWarning in mrds::check.mono(model, n.pts = 10): Detection function is not\nstrictly monotonic!\n\ndick.hr &lt;- ds(data=dick, transect = \"point\",\n         key=\"hr\", truncation = \"10%\",  convert_units = cu, adjustment = \"poly\")\n\nStarting AIC adjustment term selection.\n\n\nFitting hazard-rate key function\n\n\nAIC= 6708.399\n\n\nFitting hazard-rate key function with simple polynomial(4) adjustments\n\n\nAIC= 6710.399\n\n\n\nHazard-rate key function selected.\n\nsummarize_ds_models(dick.hn, dick.uncos, dick.hr)\n\n                 Model\n3    \\\\texttt{dick.hr}\n2 \\\\texttt{dick.uncos}\n1    \\\\texttt{dick.hn}\n                                                    Key function Formula\n3                                                    Hazard-rate      ~1\n2          Uniform with cosine adjustment terms of order 1,2,3,4    &lt;NA&gt;\n1 Half-normal with Hermite polynomial adjustment term of order 4      ~1\n  C-vM p-value $\\\\hat{P_a}$ se($\\\\hat{P_a}$) $\\\\Delta$AIC\n3  0.030839941    0.5151049       0.02079957      0.00000\n2  0.008889366    0.4895714       0.11422470      7.34863\n1  0.000541476    0.4498981       0.06111644     26.08327\n\nplot(dick.hr, pdf=TRUE, nc=40, main=\"DICK, HR, pooled detfn\")\n\n\n\n\n\n\n\n\n\ncu &lt;- convert_units(\"meter\", NULL, \"hectare\")\ngrsp &lt;- fourspec[fourspec$Species==\"GRSP\",]\ngrsp.hn &lt;- ds(data=grsp, transect = \"point\",\n         key=\"hn\", truncation = \"10%\",  convert_units = cu, adjustment = \"herm\")\n\nStarting AIC adjustment term selection.\n\n\nFitting half-normal key function\n\n\nAIC= 10188.996\n\n\nFitting half-normal key function with Hermite(4) adjustments\n\n\nAIC= 10191.08\n\n\n\nHalf-normal key function selected.\n\ngrsp.uncos &lt;- ds(data=grsp, transect = \"point\",\n         key=\"unif\", truncation = \"10%\",  convert_units = cu)\n\nStarting AIC adjustment term selection.\n\n\nFitting uniform key function\n\n\nAIC= 10361.471\n\n\nFitting uniform key function with cosine(1) adjustments\n\n\nAIC= 10196.275\n\n\nFitting uniform key function with cosine(1,2) adjustments\n\n\nAIC= 10185.799\n\n\nFitting uniform key function with cosine(1,2,3) adjustments\n\n\nAIC= 10186.734\n\n\n\nUniform key function with cosine(1,2) adjustments selected.\n\ngrsp.hr &lt;- ds(data=grsp, transect = \"point\",\n         key=\"hr\", truncation = \"10%\",  convert_units = cu, adjustment = \"poly\")\n\nStarting AIC adjustment term selection.\n\n\nFitting hazard-rate key function\n\n\nAIC= 10188.776\n\n\nFitting hazard-rate key function with simple polynomial(4) adjustments\n\n\nAIC= 10190.153\n\n\n\nHazard-rate key function selected.\n\nsummarize_ds_models(grsp.hn, grsp.uncos, grsp.hr)\n\n                 Model                                      Key function\n2 \\\\texttt{grsp.uncos} Uniform with cosine adjustment terms of order 1,2\n3    \\\\texttt{grsp.hr}                                       Hazard-rate\n1    \\\\texttt{grsp.hn}                                       Half-normal\n  Formula C-vM p-value $\\\\hat{P_a}$ se($\\\\hat{P_a}$) $\\\\Delta$AIC\n2    &lt;NA&gt;    0.2498221    0.5978788       0.05379185     0.000000\n3      ~1    0.2614903    0.6271652       0.03066799     2.976262\n1      ~1    0.2182570    0.5401211       0.02297043     3.196061\n\nplot(grsp.uncos, pdf=TRUE, nc=25, main=\"GRSP, unicos, pooled detfn\")",
    "crumbs": [
      "Sandhill birds üê¶",
      "Sandhills Grassland Birds grid as strata üê¶"
    ]
  },
  {
    "objectID": "rachel/rusten.html#constant-detectability-across-strata",
    "href": "rachel/rusten.html#constant-detectability-across-strata",
    "title": "Sandhills Grassland Birds grid as strata üê¶",
    "section": "5 Constant detectability across strata?",
    "text": "5 Constant detectability across strata?\nClearly there are insufficient detections within strata to fit stratum-specific detection functions. However, as shown in Rexstad et al. (2023), bias will result from using a pooled detection function to estimate density at the stratum level if detectability differs between strata.\nThe defensible way to estimate stratum-specific detection probabilities with small stratum-specific detections is to use stratum as a covariate. This may not work for the large number of strata we have here. The hazard rate model was preferred for two of the three species and it was second-preferred for the GRSP, so attempt covariate modelling using hazard rate as key function.\n\nweme.hrstrat &lt;- ds(data=weme, transect=\"point\", key=\"hr\", truncation=\"10%\",\n                   convert_units = cu, formula=~Region.Label)\ndick.hrstrat &lt;- ds(data=dick, transect=\"point\", key=\"hr\", truncation=\"10%\",\n                   convert_units = cu, formula=~Region.Label)\ngrsp.hrstrat &lt;- ds(data=grsp, transect=\"point\", key=\"hr\", truncation=\"10%\",\n                   convert_units = cu, formula=~Region.Label)\n\n\n\n\n\n\n\nConvergence warning)\n\n\n\n\n\nThere are convergence problems with the meadowlark data when using stratum as a covariate\n\n\n\nContrast models with and without Region.Label covariate for each species to provide an evidence-based assessment of constant detectability across strata.\n\nAIC(weme.hr, weme.hrstrat)\nAIC(dick.hr, dick.hrstrat)\nAIC(grsp.uncos, grsp.hrstrat)\n\nIf you are fussy, you could use BIC rather than AIC.\nAs an experiment, use Group as strata and fit group as a covariate. Won‚Äôt work because Area specified for the grid, not group.\n\nexperiment &lt;- fourspec\nexperiment$Region.Label &lt;- experiment$Group\nweme.group &lt;- subset(experiment, Species==\"WEME\")\nweme.hrgroup &lt;- ds(data=weme.group, transect=\"point\", key=\"hr\", truncation=\"10%\",\n                   convert_units = cu, formula=~Region.Label)\n\nDifferent idea, remove Region.Label for which there are fewer than 13 detections\n\nweme.small &lt;- subset(weme, subset = !(Region.Label %in% \n                       c(\"GAR-LOWja\", \"GAR046-B\", \"WHE035-A\", \"GAR041-B\")))\nweme.hrsmall &lt;- ds(data=weme.small, transect=\"point\", key=\"hr\", truncation=\"10%\",\n                   convert_units = cu, formula=~Region.Label)\n\nModel contains covariate term(s): no adjustment terms will be included.\n\n\nFitting hazard-rate key function\n\n\n** Warning: Estimation routine failed to converge due to an unknown error in iteration  10. Using results from previous iteration. **\n\n\n** Warning: Estimation routine failed to converge due to an unknown error in iteration  10. Using results from previous iteration. **\n\n\nAIC= 9103.185\n\nsummary(weme.hrsmall)\n\n\nSummary for distance analysis \nNumber of observations :  931 \nDistance range         :  0  -  190 \n\nModel       : Hazard-rate key function \nAIC         :  9103.185 \nOptimisation:  mrds (nlminb) \n\nDetection function parameters\nScale coefficient(s):  \n                           estimate           se\n(Intercept)              4.94645119 6.525205e-02\nRegion.LabelDismal E    -0.09898793 9.105704e-02\nRegion.LabelDouble E    -0.48017600 7.968692e-02\nRegion.LabelDouble M    -0.76208822 8.715162e-02\nRegion.LabelDouble W     0.16661410 1.322101e-01\nRegion.LabelGAR-ML-A     0.06363104 1.083295e-01\nRegion.LabelGAR-PLU     -0.35632627 1.128270e-01\nRegion.LabelGAR-WIL-A    0.54376699 2.274367e+01\nRegion.LabelGAR-WIL-B   -0.04968083 1.051625e-01\nRegion.LabelGAR-WIL-C   -0.45767581 9.180870e-02\nRegion.LabelGAR045-A     0.01273958 1.009338e-01\nRegion.LabelGAR045-B    -0.66903948 8.160782e-02\nRegion.LabelGAR046-A    -0.17214499 1.246247e-01\nRegion.LabelGAR046-C    -0.25654246 8.636839e-02\nRegion.LabelGAR046-H    -0.18178372 9.654064e-02\nRegion.LabelGAR046-M     0.68669221 6.959943e+04\nRegion.LabelGAR053-A    -0.36342773 8.899581e-02\nRegion.LabelGAR053-B    -0.03861203 1.024551e-01\nRegion.LabelGAR054      -0.28697648 9.158323e-02\nRegion.LabelLOU-SMI-A    0.13300574 1.230811e-01\nRegion.LabelLOU-SMI-B   -0.31330893 8.420630e-02\nRegion.LabelLOU-SMI-C    0.68949050 9.499671e+04\nRegion.LabelLOU-SWMB     0.16202358 1.243490e-01\nRegion.LabelValentine A  0.02072083 1.347519e-01\nRegion.LabelValentine B -0.45249016 1.149010e-01\nRegion.LabelWeggener     0.69837519 1.000000e+05\nRegion.LabelWHE014       0.68394282 7.281399e+04\nRegion.LabelWHE035-B    -0.37005766 8.532086e-02\nRegion.LabelWHE035-C     0.09892840 1.061699e-01\n\nShape coefficient(s):  \n            estimate         se\n(Intercept) 1.976887 0.08281657\n\n                        Estimate           SE         CV\nAverage p              0.3966295   0.01386618 0.03496004\nN in covered region 2347.2789834 105.26901817 0.04484725\n\nSummary statistics:\n        Region   Area CoveredArea Effort   n   k       ER     se.ER      cv.ER\n1     BLA049-C  256.0   136.09379     12  41  12 3.416667 0.3361622 0.09838895\n2     Dismal E  256.0   136.09379     12  41  12 3.416667 0.5143153 0.15053130\n3     Double E  256.0   136.09379     12  55  12 4.583333 0.4344682 0.09479306\n4     Double M  256.0   136.09379     12  42  12 3.500000 0.2302831 0.06579517\n5     Double W  256.0   113.41149     10  21  10 2.100000 0.3480102 0.16571915\n6     GAR-ML-A  256.0   136.09379     12  29  12 2.416667 0.2289083 0.09472066\n7      GAR-PLU  170.7   102.07035      9  23   9 2.555556 0.3379313 0.13223397\n8    GAR-WIL-A  256.0   124.75264     11  12  11 1.090909 0.2845905 0.26087460\n9    GAR-WIL-B  256.0   136.09379     12  28  12 2.333333 0.2842676 0.12182898\n10   GAR-WIL-C  256.0   124.75264     11  38  11 3.454545 0.2073046 0.06000923\n11    GAR045-A  256.0   124.75264     11  30  11 2.727273 0.3835459 0.14063349\n12    GAR045-B  256.0   136.09379     12  51  12 4.250000 0.2500000 0.05882353\n13    GAR046-A  256.0   124.75264     11  18  11 1.636364 0.3377123 0.20637973\n14    GAR046-C  256.0   136.09379     12  47  12 3.916667 0.3128155 0.07986779\n15    GAR046-H  256.0   124.75264     11  34  11 3.090909 0.5633430 0.18225804\n16    GAR046-M  256.0   136.09379     12  22  12 1.833333 0.3658393 0.19954870\n17    GAR053-A  256.0   113.41149     10  36  10 3.600000 0.3399346 0.09442629\n18    GAR053-B  234.7   124.75264     11  28  11 2.545455 0.3659020 0.14374723\n19      GAR054  256.0   124.75264     11  38  11 3.454545 0.2816715 0.08153649\n20   LOU-SMI-A  256.0   136.09379     12  19  12 1.583333 0.3361622 0.21231299\n21   LOU-SMI-B  256.0   136.09379     12  51  12 4.250000 0.3046359 0.07167903\n22   LOU-SMI-C  256.0   136.09379     12  25  12 2.083333 0.2599048 0.12475430\n23    LOU-SWMB  256.0   136.09379     12  24  12 2.000000 0.2132007 0.10660036\n24 Valentine A  234.7   102.07035      9  14   9 1.555556 0.2939724 0.18898224\n25 Valentine B  256.0    79.38805      7  20   7 2.857143 0.3400680 0.11902381\n26    Weggener  256.0   136.09379     12  42  12 3.500000 0.3793935 0.10839813\n27      WHE014  256.0   136.09379     12  25  12 2.083333 0.4515685 0.21675290\n28    WHE035-B  256.0   136.09379     12  49  12 4.083333 0.4680445 0.11462314\n29    WHE035-C  256.0   113.41149     10  28  10 2.800000 0.4422166 0.15793451\n30       Total 7296.1  3674.53243    324 931 324 2.860505 0.0656242 0.02294147\n\nAbundance:\n         Label   Estimate         se         cv        lcl        ucl        df\n1     BLA049-C  118.70972  17.215860 0.14502486   88.85934  158.58770  51.06773\n2     Dismal E  141.02462  27.089072 0.19208754   95.54908  208.14375  29.02645\n3     Double E  392.39986  53.963325 0.13752126  297.99363  516.71457  48.01127\n4     Double M  524.51029  72.904104 0.13899461  399.26083  689.05092 191.10608\n5     Double W   57.02132  12.499425 0.21920615   36.56973   88.91046  27.39879\n6     GAR-ML-A   75.80181  12.583016 0.16599889   54.65079  105.13873  98.59678\n7      GAR-PLU  114.41792  25.780601 0.22531960   73.36643  178.43939  65.33755\n8    GAR-WIL-A   24.62775   7.219508 0.29314529   13.39639   45.27532  15.93206\n9    GAR-WIL-B   88.24552  16.903681 0.19155285   60.40434  128.91909  65.49423\n10   GAR-WIL-C  282.92719  41.074070 0.14517541  212.90929  375.97135 271.55849\n11    GAR045-A   92.77816  17.790862 0.19175701   63.06368  136.49355  34.28516\n12    GAR045-B  529.14572  63.939111 0.12083460  417.22934  671.08224 173.85986\n13    GAR046-A   77.24488  22.183870 0.28718886   43.66914  136.63589  37.13606\n14    GAR046-C  216.86971  30.177693 0.13915126  164.74920  285.47922  96.47702\n15    GAR046-H  148.55765  33.873275 0.22801434   93.38562  236.32521  24.40985\n16    GAR046-M   41.38322   8.273012 0.19991222   26.77746   63.95570  11.08037\n17    GAR053-A  245.09230  38.218851 0.15593656  179.84164  334.01740  64.99962\n18    GAR053-B   86.57868  17.412508 0.20111774   57.85371  129.56590  37.93209\n19      GAR054  202.78885  30.868462 0.15221972  150.25522  273.68979 113.67881\n20   LOU-SMI-A   44.90743  11.486139 0.25577369   26.68213   75.58157  23.11167\n21   LOU-SMI-B  262.49512  34.344531 0.13083874  202.78645  339.78448 114.51306\n22   LOU-SMI-C   47.02639   5.892973 0.12531204   35.75050   61.85876  11.19802\n23    LOU-SWMB   54.61787   9.386019 0.17184888   38.87221   76.74149  72.04413\n24 Valentine A   47.88483  13.004811 0.27158521   27.84161   82.35718  33.78133\n25 Valentine B  231.62254  52.222021 0.22546174  148.62392  360.97151  73.95260\n26    Weggener   79.00434   8.570188 0.10847744   62.27302  100.23097  11.03223\n27      WHE014   47.02639  10.225681 0.21744558   29.32271   75.41873  11.14128\n28    WHE035-B  281.61772  45.881752 0.16292211  203.24663  390.20840  44.33418\n29    WHE035-C   83.30446  16.739493 0.20094354   55.22438  125.66247  23.49484\n30       Total 4639.63227 179.271162 0.03863909 4300.87187 5005.07530 802.35754\n\nDensity:\n         Label   Estimate         se         cv        lcl       ucl        df\n1     BLA049-C 0.46370984 0.06724945 0.14502486 0.34710679 0.6194832  51.06773\n2     Dismal E 0.55087741 0.10581669 0.19208754 0.37323857 0.8130615  29.02645\n3     Double E 1.53281197 0.21079424 0.13752126 1.16403763 2.0184163  48.01127\n4     Double M 2.04886831 0.28478165 0.13899461 1.55961261 2.6916052 191.10608\n5     Double W 0.22273954 0.04882588 0.21920615 0.14285049 0.3473065  27.39879\n6     GAR-ML-A 0.29610082 0.04915241 0.16599889 0.21347963 0.4106982  98.59678\n7      GAR-PLU 0.67028659 0.15102871 0.22531960 0.42979748 1.0453391  65.33755\n8    GAR-WIL-A 0.09620214 0.02820120 0.29314529 0.05232966 0.1768567  15.93206\n9    GAR-WIL-B 0.34470907 0.06603000 0.19155285 0.23595444 0.5035902  65.49423\n10   GAR-WIL-C 1.10518433 0.16044558 0.14517541 0.83167691 1.4686381 271.55849\n11    GAR045-A 0.36241467 0.06949555 0.19175701 0.24634252 0.5331779  34.28516\n12    GAR045-B 2.06697548 0.24976215 0.12083460 1.62980210 2.6214150 173.85986\n13    GAR046-A 0.30173783 0.08665574 0.28718886 0.17058259 0.5337339  37.13606\n14    GAR046-C 0.84714732 0.11788161 0.13915126 0.64355155 1.1151532  96.47702\n15    GAR046-H 0.58030332 0.13231748 0.22801434 0.36478757 0.9231453  24.40985\n16    GAR046-M 0.16165322 0.03231645 0.19991222 0.10459946 0.2498270  11.08037\n17    GAR053-A 0.95739181 0.14929239 0.15593656 0.70250640 1.3047555  64.99962\n18    GAR053-B 0.36889084 0.07419049 0.20111774 0.24650067 0.5520490  37.93209\n19      GAR054 0.79214396 0.12057993 0.15221972 0.58693445 1.0691007 113.67881\n20   LOU-SMI-A 0.17541965 0.04486773 0.25577369 0.10422707 0.2952405  23.11167\n21   LOU-SMI-B 1.02537155 0.13415832 0.13083874 0.79213455 1.3272831 114.51306\n22   LOU-SMI-C 0.18369684 0.02301943 0.12531204 0.13965039 0.2416358  11.19802\n23    LOU-SWMB 0.21335104 0.03666414 0.17184888 0.15184459 0.2997714  72.04413\n24 Valentine A 0.20402568 0.05541036 0.27158521 0.11862638 0.3509041  33.78133\n25 Valentine B 0.90477553 0.20399227 0.22546174 0.58056217 1.4100450  73.95260\n26    Weggener 0.30861069 0.03347730 0.10847744 0.24325399 0.3915272  11.03223\n27      WHE014 0.18369684 0.03994407 0.21744558 0.11454183 0.2946044  11.14128\n28    WHE035-B 1.10006923 0.17922560 0.16292211 0.79393215 1.5242515  44.33418\n29    WHE035-C 0.32540803 0.06538864 0.20094354 0.21572025 0.4908690  23.49484\n30       Total 0.63590579 0.02457082 0.03863909 0.58947546 0.6859932 802.35754\n\n\nThe convergence may still not be perfect; however the CVs at the stratum level are reasonable, staying below 0.35.\n\nplot(weme.hrsmall, pdf=TRUE)\nrlabels &lt;- unique(weme.small$Region.Label)\nfor (i in 1:length(rlabels)) {\n  add_df_covar_line(weme.hrsmall, data=data.frame(Region.Label=rlabels[i]),\n                    lwd=2, lty=1, pdf=TRUE, col=colours(TRUE)[i])\n}\nlegend(\"topright\", title=\"Strata\", legend=rlabels,\n       lwd=2, lty=1, col=colours(TRUE), cex=0.8)\n\n\n\n\n\n\n\n\nThe plot of the probability density functions at the stratum level indicates one stratum with a very different detection function shape compared to the rest of the strata (WHE014). This may explain the convergence challenge. That stratum might be a candidate for exclusion.\n\nhist(weme$distance[weme$Region.Label==\"WHE014\"], xlim=c(0,190), nc=10,\n     xlab=\"Radial distance\", main=\"Stratum WHE014 detections of WEME\")\n\n\n\n\n\n\n\n\nNote the SE of the stratum-\\(\\hat{\\beta}\\) associated with stratum WHE014 7.2813986^{4}",
    "crumbs": [
      "Sandhill birds üê¶",
      "Sandhills Grassland Birds grid as strata üê¶"
    ]
  },
  {
    "objectID": "natalie/pegg.html#pooled-detection-function",
    "href": "natalie/pegg.html#pooled-detection-function",
    "title": "Mourning doves üïäÔ∏è",
    "section": "10.1 Pooled detection function",
    "text": "10.1 Pooled detection function\n\nmodo.pool.unif &lt;- ds(data=clean.data[clean.data$Species==\"Mourning Dove\",], \n                   region_table = regtab, sample_table = samtab,\n                   transect = \"point\", key=\"unif\", truncation = \"10%\", convert_units = cu)\nmodo.pool.hn &lt;- ds(data=clean.data[clean.data$Species==\"Mourning Dove\",], \n                   region_table = regtab, sample_table = samtab,\n                   transect = \"point\", key=\"hn\", adj=\"herm\", truncation = \"10%\", convert_units = cu)\nmodo.pool.hr &lt;- ds(data=clean.data[clean.data$Species==\"Mourning Dove\",], \n                   region_table = regtab, sample_table = samtab,\n                   transect = \"point\", key=\"hr\", adj=\"poly\", truncation = \"10%\", convert_units = cu)",
    "crumbs": [
      "Mourning doves üïäÔ∏è"
    ]
  },
  {
    "objectID": "natalie/pegg.html#model-criticism",
    "href": "natalie/pegg.html#model-criticism",
    "title": "Mourning doves üïäÔ∏è",
    "section": "10.2 Model criticism",
    "text": "10.2 Model criticism\n\nknitr::kable(summarize_ds_models(modo.pool.unif, modo.pool.hn, modo.pool.hr)[,c(1,3:7)], \n             digits=3, row.names = FALSE,\n             caption=\"Model criticism for 8 stratum pooled detection function models.\")\n\n\nModel criticism for 8 stratum pooled detection function models.\n\n\n\n\n\n\n\n\n\n\nModel\nFormula\nC-vM p-value\n\\(\\hat{P_a}\\)\nse(\\(\\hat{P_a}\\))\n\\(\\Delta\\)AIC\n\n\n\n\n\n~1\n0.888\n0.162\n0.041\n0.000\n\n\n\nNA\n0.245\n0.198\n0.022\n3.757\n\n\n\n~1\n0.121\n0.215\n0.023\n5.065",
    "crumbs": [
      "Mourning doves üïäÔ∏è"
    ]
  },
  {
    "objectID": "natalie/pegg.html#location-x-treatment-specific-detection-function",
    "href": "natalie/pegg.html#location-x-treatment-specific-detection-function",
    "title": "Mourning doves üïäÔ∏è",
    "section": "10.3 Location x treatment specific detection function",
    "text": "10.3 Location x treatment specific detection function\n\nmodo.hn.region &lt;- ds(data=clean.data[clean.data$Species==\"Mourning Dove\",], \n                   region_table = regtab, sample_table = samtab,\n                   transect = \"point\", key=\"hn\",\n                   formula=~Region.Label,\n                   truncation = \"10%\", convert_units = cu)\nmodo.hr.region &lt;- ds(data=clean.data[clean.data$Species==\"Mourning Dove\",], \n                   region_table = regtab, sample_table = samtab,\n                   transect = \"point\", key=\"hr\",\n                   formula=~Region.Label,\n                   truncation = \"10%\", convert_units = cu)\n\n\nknitr::kable(summarize_ds_models(modo.hn.region, modo.hr.region)[,c(1,3:7)], \n             digits=3, row.names = FALSE,\n             caption=\"Model criticism for 8 stratum-specific detection function models.\")\n\n\nModel criticism for 8 stratum-specific detection function models.\n\n\n\n\n\n\n\n\n\n\nModel\nFormula\nC-vM p-value\n\\(\\hat{P_a}\\)\nse(\\(\\hat{P_a}\\))\n\\(\\Delta\\)AIC\n\n\n\n\n\n~Region.Label\n0.550\n0.141\n319.606\n0.000\n\n\n\n~Region.Label\n0.481\n0.158\n901.717\n4.061\n\n\n\n\n\nSomething is not right about SE(Pa) for both models, suggesting convergence trouble\n\nknitr::kable(summary(modo.hr.region$ddf)$coeff$key.scale, digits=4,\n             caption=\"Problems in SEs of beta coefficients\")\n\n\nProblems in SEs of beta coefficients\n\n\n\nestimate\nse\n\n\n\n\n(Intercept)\n4.3687\n0.3521\n\n\nRegion.LabelGarden City_Urban\n0.2568\n7.0672\n\n\nRegion.LabelGarden City_WMA\n-0.7177\n0.4575\n\n\nRegion.LabelMcPherson_Rural\n1.3277\n64622.7824\n\n\nRegion.LabelMcPherson_Urban\n-0.4431\n0.3848\n\n\nRegion.LabelMcPherson_WMA\n-0.6397\n99999.9995\n\n\nRegion.LabelTopeka_Urban\n-1.1236\n0.4208\n\n\nRegion.LabelTopeka_WMA\n-0.6590\n0.4339\n\n\n\n\n\nMcPherson Rural and WMA, as well as Garden City Urban causing problems\nProbably not a surprise given the numbers of detections in those locations x treatments\n\nknitr::kable(modo.hr.region$dht$individuals$summary, digits=3,\n             caption=\"MODO by location X treatment. Pay attention to Effort, n (detections) and k (points) columns.\")\n\n\nMODO by location X treatment. Pay attention to Effort, n (detections) and k (points) columns.\n\n\n\n\n\n\n\n\n\n\n\n\n\nRegion\nArea\nCoveredArea\nEffort\nn\nk\nER\nse.ER\ncv.ER\n\n\n\n\nGarden City_Rural\n20.230\n166.237\n26\n7\n15\n0.269\n0.332\n1.232\n\n\nGarden City_Urban\n2284.370\n703.310\n110\n2\n55\n0.018\n0.013\n0.701\n\n\nGarden City_WMA\n1521.618\n230.174\n36\n8\n27\n0.222\n0.116\n0.523\n\n\nMcPherson_Rural\n1007.840\n300.505\n47\n2\n33\n0.043\n0.033\n0.786\n\n\nMcPherson_Urban\n1827.561\n466.742\n73\n24\n44\n0.329\n0.079\n0.240\n\n\nMcPherson_WMA\n539.040\n262.143\n41\n1\n24\n0.024\n0.021\n0.854\n\n\nTopeka_Urban\n19250.760\n402.805\n63\n16\n38\n0.254\n0.062\n0.243\n\n\nTopeka_WMA\n4249.200\n479.530\n75\n10\n44\n0.133\n0.040\n0.298\n\n\nTotal\n30700.619\n3011.447\n471\n70\n280\n0.212\n0.040\n0.188\n\n\n\n\n\nSee Section¬†11 eliminate Garden City_Urban, McPherson_Rural and McPherson_WMA for a more reliable model resulting from elimination of strata with very few detections.\n\n\n\n\n\n\nFor the moment, show estimates from pooled HR model\n\n\n\n\n\n\nknitr::kable(modo.pool.hr$dht$individuals$D[,1:6], digits=3, \n             caption=\"MODO density (per hectare) using pooled detection function across location x treatment combos\")\n\n\nMODO density (per hectare) using pooled detection function across location x treatment combos\n\n\nLabel\nEstimate\nse\ncv\nlcl\nucl\n\n\n\n\nGarden City_Rural\n0.260\n0.327\n1.257\n0.033\n2.069\n\n\nGarden City_Urban\n0.018\n0.013\n0.744\n0.005\n0.066\n\n\nGarden City_WMA\n0.215\n0.125\n0.581\n0.072\n0.639\n\n\nMcPherson_Rural\n0.041\n0.034\n0.825\n0.010\n0.177\n\n\nMcPherson_Urban\n0.318\n0.110\n0.348\n0.163\n0.621\n\n\nMcPherson_WMA\n0.024\n0.021\n0.890\n0.005\n0.113\n\n\nTopeka_Urban\n0.245\n0.086\n0.350\n0.125\n0.482\n\n\nTopeka_WMA\n0.129\n0.050\n0.390\n0.061\n0.272\n\n\nTotal\n0.205\n0.064\n0.314\n0.111\n0.376\n\n\n\n\n\n\nNote the magnitude of CVs for Garden City_Rural, Garden City_Urban, McPherson_Rural and McPherson_WMA\nMost of those large CVs were caused by very low density, but that is not the case for Garden City_Rural.",
    "crumbs": [
      "Mourning doves üïäÔ∏è"
    ]
  },
  {
    "objectID": "natalie/pegg.html#for-the-moment-show-estimates-from-pooled-hr-model",
    "href": "natalie/pegg.html#for-the-moment-show-estimates-from-pooled-hr-model",
    "title": "Mourning doves üïäÔ∏è",
    "section": "11.1 For the moment, show estimates from pooled HR model",
    "text": "11.1 For the moment, show estimates from pooled HR model\n\nknitr::kable(modo.pool.hr$dht$individuals$D[,1:6], digits=3, \n             caption=\"MODO density (per hectare) using pooled detection function across location x treatment combos\")\n\n\nMODO density (per hectare) using pooled detection function across location x treatment combos\n\n\nLabel\nEstimate\nse\ncv\nlcl\nucl\n\n\n\n\nGarden City_Rural\n0.260\n0.327\n1.257\n0.033\n2.069\n\n\nGarden City_Urban\n0.018\n0.013\n0.744\n0.005\n0.066\n\n\nGarden City_WMA\n0.215\n0.125\n0.581\n0.072\n0.639\n\n\nMcPherson_Rural\n0.041\n0.034\n0.825\n0.010\n0.177\n\n\nMcPherson_Urban\n0.318\n0.110\n0.348\n0.163\n0.621\n\n\nMcPherson_WMA\n0.024\n0.021\n0.890\n0.005\n0.113\n\n\nTopeka_Urban\n0.245\n0.086\n0.350\n0.125\n0.482\n\n\nTopeka_WMA\n0.129\n0.050\n0.390\n0.061\n0.272\n\n\nTotal\n0.205\n0.064\n0.314\n0.111\n0.376\n\n\n\n\n\nNote the magnitude of CVs for Garden City_Rural, Garden City_Urban, McPherson_Rural and McPherson_WMA\nMost of those large CVs were caused by very low density, but that is not the case for Garden City_Rural.",
    "crumbs": [
      "Mourning doves üïäÔ∏è"
    ]
  },
  {
    "objectID": "natalie/pegg.html#reconstruct-sample-table",
    "href": "natalie/pegg.html#reconstruct-sample-table",
    "title": "Mourning doves üïäÔ∏è",
    "section": "11.1 Reconstruct sample table",
    "text": "11.1 Reconstruct sample table\nBorrowing from our earlier code and removing the unwanted strata\n\nallpts5strat &lt;- c(gcr, gcw, mu, tu, tw)\nregionstring5 &lt;- c(rep(combo.more.clean[1], pts.gcr),\n                   rep(combo.more.clean[2], pts.gcw),\n                   rep(combo.more.clean[3], pts.mu),\n                   rep(combo.more.clean[4], pts.tu),\n                   rep(combo.more.clean[5], pts.tw))\n\neff5 &lt;- vector(\"numeric\", length=length(allpts5strat))\nfor(i in 1:length(allpts5strat)) {\n  eff5[i] &lt;- cleaner.data[cleaner.data$Sample.Label==allpts5strat[i], \"Effort\"]\n}\n\nsamtab5 &lt;- data.frame(Sample.Label=allpts5strat,\n                     Region.Label=regionstring5,\n                     Effort=eff5)",
    "crumbs": [
      "Mourning doves üïäÔ∏è"
    ]
  },
  {
    "objectID": "natalie/pegg.html#pooled-detection-function-1",
    "href": "natalie/pegg.html#pooled-detection-function-1",
    "title": "Mourning doves üïäÔ∏è",
    "section": "12.1 Pooled detection function",
    "text": "12.1 Pooled detection function\n\nmodo.pool.unif5 &lt;- ds(data=cleaner.data[cleaner.data$Species==\"Mourning Dove\",], \n                      region_table = regtab5strata, sample_table = samtab5,\n                      transect = \"point\", key=\"unif\", truncation = \"10%\", convert_units = cu)\nmodo.pool.hn5 &lt;- ds(data=cleaner.data[cleaner.data$Species==\"Mourning Dove\",], \n                    region_table = regtab5strata, sample_table = samtab5,\n                    transect = \"point\", key=\"hn\", adj=\"herm\", truncation = \"10%\", convert_units = cu)\nmodo.pool.hr5 &lt;- ds(data=cleaner.data[cleaner.data$Species==\"Mourning Dove\",], \n                    region_table = regtab5strata, sample_table = samtab5,\n                    transect = \"point\", key=\"hr\", adj=\"poly\", truncation = \"10%\", convert_units = cu)",
    "crumbs": [
      "Mourning doves üïäÔ∏è"
    ]
  },
  {
    "objectID": "natalie/pegg.html#model-criticism-of-5-stratum-pooled-models",
    "href": "natalie/pegg.html#model-criticism-of-5-stratum-pooled-models",
    "title": "Mourning doves üïäÔ∏è",
    "section": "12.2 Model criticism of 5 stratum pooled models",
    "text": "12.2 Model criticism of 5 stratum pooled models\n\nknitr::kable(summarize_ds_models(modo.pool.unif5, modo.pool.hn5, modo.pool.hr5)[,c(1,3:7)],\n             digits=3, row.names = FALSE,\n             caption=\"Model criticism for 5 stratum pooled detection function models.\")\n\n\nModel criticism for 5 stratum pooled detection function models.\n\n\n\n\n\n\n\n\n\n\nModel\nFormula\nC-vM p-value\n\\(\\hat{P_a}\\)\nse(\\(\\hat{P_a}\\))\n\\(\\Delta\\)AIC\n\n\n\n\n\n~1\n0.916\n0.179\n0.045\n0.000\n\n\n\nNA\n0.858\n0.155\n0.029\n3.018\n\n\n\n~1\n0.186\n0.222\n0.026\n3.889",
    "crumbs": [
      "Mourning doves üïäÔ∏è"
    ]
  },
  {
    "objectID": "natalie/pegg.html#stratum-specific-detection-function",
    "href": "natalie/pegg.html#stratum-specific-detection-function",
    "title": "Mourning doves üïäÔ∏è",
    "section": "12.3 Stratum-specific detection function",
    "text": "12.3 Stratum-specific detection function\n\nmodo.hn.region5 &lt;- ds(data=cleaner.data[cleaner.data$Species==\"Mourning Dove\",], \n                      region_table = regtab5strata, sample_table = samtab5,\n                      transect = \"point\", key=\"hn\",\n                      formula=~Region.Label,\n                      truncation = \"10%\", convert_units = cu)\nmodo.hr.region5 &lt;- ds(data=cleaner.data[cleaner.data$Species==\"Mourning Dove\",], \n                      region_table = regtab5strata, sample_table = samtab5,\n                      transect = \"point\", key=\"hr\",\n                      formula=~Region.Label,\n                      truncation = \"10%\", convert_units = cu)\n\n\nknitr::kable(summarize_ds_models(modo.hn.region, modo.hr.region)[,c(1,3:7)], \n             digits=3, row.names = FALSE,\n             caption=\"Model criticism for 5 stratum-specific detection function models.\")\n\n\nModel criticism for 5 stratum-specific detection function models.\n\n\n\n\n\n\n\n\n\n\nModel\nFormula\nC-vM p-value\n\\(\\hat{P_a}\\)\nse(\\(\\hat{P_a}\\))\n\\(\\Delta\\)AIC\n\n\n\n\n\n~Region.Label\n0.550\n0.141\n319.606\n0.000\n\n\n\n~Region.Label\n0.481\n0.158\n901.717\n4.061\n\n\n\n\n\n\n12.3.1 Look for signs of convergence problems in covariate \\(\\hat{\\beta_i}\\) estimates\n\nbob &lt;- summary(modo.hr.region5$ddf)\nknitr::kable(bob$coeff$key.scale, digits=4)\n\n\n\n\n\nestimate\nse\n\n\n\n\n(Intercept)\n4.4216\n0.3798\n\n\nRegion.LabelGarden City_WMA\n-0.7825\n0.4990\n\n\nRegion.LabelMcPherson_Urban\n-0.5401\n0.4197\n\n\nRegion.LabelTopeka_Urban\n-1.1985\n0.4614\n\n\nRegion.LabelTopeka_WMA\n-0.7207\n0.4730\n\n\n\n\n\nNo reason to be concerned about convergence, so make inference from this model.",
    "crumbs": [
      "Mourning doves üïäÔ∏è"
    ]
  },
  {
    "objectID": "natalie/pegg.html#repeat-summary-table-for-5-strata",
    "href": "natalie/pegg.html#repeat-summary-table-for-5-strata",
    "title": "Mourning doves üïäÔ∏è",
    "section": "12.4 Repeat summary table for 5 strata",
    "text": "12.4 Repeat summary table for 5 strata\n\nknitr::kable(modo.hr.region5$dht$individuals$summary, digits=3,\n             caption=\"MODO by location X treatment for five strata analysis. Pay attention to Effort, n (detections) and k (points) columns.\")\n\n\nMODO by location X treatment for five strata analysis. Pay attention to Effort, n (detections) and k (points) columns.\n\n\n\n\n\n\n\n\n\n\n\n\n\nRegion\nArea\nCoveredArea\nEffort\nn\nk\nER\nse.ER\ncv.ER\n\n\n\n\nGarden City_Rural\n20.230\n137.405\n26\n7\n15\n0.269\n0.332\n1.232\n\n\nGarden City_WMA\n1521.618\n190.253\n36\n8\n27\n0.222\n0.116\n0.523\n\n\nMcPherson_Urban\n1827.561\n385.792\n73\n23\n44\n0.315\n0.071\n0.224\n\n\nTopeka_Urban\n19250.760\n332.943\n63\n16\n38\n0.254\n0.062\n0.243\n\n\nTopeka_WMA\n4249.200\n396.361\n75\n10\n44\n0.133\n0.040\n0.298\n\n\nTotal\n26869.369\n1442.755\n273\n64\n168\n0.237\n0.045\n0.192",
    "crumbs": [
      "Mourning doves üïäÔ∏è"
    ]
  },
  {
    "objectID": "natalie/pegg.html#examine-the-shape-of-the-stratum-specific-probability-density-functions",
    "href": "natalie/pegg.html#examine-the-shape-of-the-stratum-specific-probability-density-functions",
    "title": "Mourning doves üïäÔ∏è",
    "section": "12.5 Examine the shape of the stratum-specific probability density functions",
    "text": "12.5 Examine the shape of the stratum-specific probability density functions\n\nplot(modo.hr.region5, pdf=TRUE, nc=18, pl.col=\"white\")\nfor(i in 1:length(combo.more.clean)) {\n  add_df_covar_line(modo.hr.region5, data=data.frame(Region.Label=combo.more.clean[i]),\n                    lwd=3, lty=1, col=i, pdf=TRUE)\n}\nlegend(\"topright\", title=\"Loc x treatment\", legend = combo.more.clean,\n       lwd=3, lty=1, col=1:5)",
    "crumbs": [
      "Mourning doves üïäÔ∏è"
    ]
  },
  {
    "objectID": "natalie/pegg.html#finally-the-density-estimates",
    "href": "natalie/pegg.html#finally-the-density-estimates",
    "title": "Mourning doves üïäÔ∏è",
    "section": "12.6 Finally the density estimates",
    "text": "12.6 Finally the density estimates\n\nknitr::kable(modo.hr.region5$dht$individuals$D[,1:6], digits=3, \n             caption=\"MODO density (per hectare) using stratum-specific detection function across five location x treatment combinations.\")\n\n\nMODO density (per hectare) using stratum-specific detection function across five location x treatment combinations.\n\n\nLabel\nEstimate\nse\ncv\nlcl\nucl\n\n\n\n\nGarden City_Rural\n0.087\n0.115\n1.322\n0.011\n0.717\n\n\nGarden City_WMA\n0.247\n0.190\n0.767\n0.064\n0.959\n\n\nMcPherson_Urban\n0.230\n0.088\n0.381\n0.111\n0.479\n\n\nTopeka_Urban\n0.606\n0.316\n0.522\n0.228\n1.607\n\n\nTopeka_WMA\n0.133\n0.076\n0.570\n0.046\n0.382\n\n\nTotal\n0.485\n0.229\n0.473\n0.198\n1.185\n\n\n\n\n\n\nsimplename &lt;- modo.hr.region5$dht$individuals$D\nsimplename$index &lt;- 1:dim(simplename)[1]\nyrange &lt;- range(c(simplename$lcl, simplename$ucl))\nplot(simplename$index[1:(max(simplename$index)-1)],\n     simplename$Estimate[1:(max(simplename$index)-1)], \n     ylim=c(0, yrange[2]), xaxt=\"n\",\n     xlab=\"Location x treatment\", ylab=\"Density (per hectare)\",\n     main=\"Mourning dove estimates 2024 from covariate model\")\ns &lt;- seq((max(simplename$index)-1))\nsegments(simplename$index[s], simplename$lcl[s], simplename$index[s], simplename$ucl[s])\naxis(1, at=1:(max(simplename$index)-1), labels=simplename$Label[1:(max(simplename$index)-1)], cex.axis=0.9)",
    "crumbs": [
      "Mourning doves üïäÔ∏è"
    ]
  },
  {
    "objectID": "natalie/pegg.html#alternative-model-selection-metric",
    "href": "natalie/pegg.html#alternative-model-selection-metric",
    "title": "Mourning doves üïäÔ∏è",
    "section": "13.1 Alternative model selection metric",
    "text": "13.1 Alternative model selection metric\nThe tools for employing different metrics exist, but need to be recrafted a bit for our purposes:\n\naltmetric &lt;- function(modelobj) {\n  nval &lt;- length(modelobj$ddf$fitted)\n  AICcall &lt;- AIC(modelobj)\n  k &lt;- AICcall$df\n  AICval &lt;- AICcall$AIC\n  AICc &lt;- AICval + (2*k*(k+1)) / (nval-k-1)\n  BIC &lt;- AIC(modelobj, k = log(nval))$AIC\n  return(c(AICval, AICc, BIC))\n}\n\nPass each of our five models (three without covariates and two using the stratum as covariate) applied to the five-stratum variant of our analysis to our new tool, admittedly in a clumsy fashion.\n\nresults &lt;- data.frame(NULL)\nresults &lt;- rbind(results, altmetric(modo.pool.unif5))\nresults &lt;- rbind(results, altmetric(modo.pool.hn5))\nresults &lt;- rbind(results, altmetric(modo.pool.hr5))\nresults &lt;- rbind(results, altmetric(modo.hn.region5))\nresults &lt;- rbind(results, altmetric(modo.hr.region5))\ncolnames(results) &lt;- c(\"AIC\", \"AICc\", \"BIC\")\nrownames(results) &lt;- c(\"modo.pool.unif5\",\"modo.pool.hn5\",\"modo.pool.hr5\",\n                       \"modo.hn.region5\",\"modo.hr.region5\")\nknitr::kable(results[order(results$AIC),], digits=1, \n             row.names = TRUE, caption=\"Models ordered by AIC\")\n\n\nModels ordered by AIC\n\n\n\nAIC\nAICc\nBIC\n\n\n\n\nmodo.hr.region5\n598.6\n600.1\n611.5\n\n\nmodo.hn.region5\n601.2\n602.3\n612.0\n\n\nmodo.pool.hr5\n603.8\n604.0\n608.1\n\n\nmodo.pool.unif5\n606.8\n607.2\n613.3\n\n\nmodo.pool.hn5\n607.7\n607.7\n609.8\n\n\n\n\nknitr::kable(results[order(results$AICc),], digits=1, \n             row.names = TRUE, caption=\"Models ordered by AICc\") \n\n\nModels ordered by AICc\n\n\n\nAIC\nAICc\nBIC\n\n\n\n\nmodo.hr.region5\n598.6\n600.1\n611.5\n\n\nmodo.hn.region5\n601.2\n602.3\n612.0\n\n\nmodo.pool.hr5\n603.8\n604.0\n608.1\n\n\nmodo.pool.unif5\n606.8\n607.2\n613.3\n\n\nmodo.pool.hn5\n607.7\n607.7\n609.8\n\n\n\n\nknitr::kable(results[order(results$BIC),], digits=1, \n             row.names = TRUE, caption=\"Models ordered by BIC\")\n\n\nModels ordered by BIC\n\n\n\nAIC\nAICc\nBIC\n\n\n\n\nmodo.pool.hr5\n603.8\n604.0\n608.1\n\n\nmodo.pool.hn5\n607.7\n607.7\n609.8\n\n\nmodo.hr.region5\n598.6\n600.1\n611.5\n\n\nmodo.hn.region5\n601.2\n602.3\n612.0\n\n\nmodo.pool.unif5\n606.8\n607.2\n613.3\n\n\n\n\n\nThe upshot of changing metrics is that using AICc vs AIC results in the same model choice, whereas use of BIC leads to the selection of a pooled detection function (with a hazard rate key).",
    "crumbs": [
      "Mourning doves üïäÔ∏è"
    ]
  },
  {
    "objectID": "natalie/pegg.html#how-much-does-model-choice-influence-our-estimates",
    "href": "natalie/pegg.html#how-much-does-model-choice-influence-our-estimates",
    "title": "Mourning doves üïäÔ∏è",
    "section": "13.2 How much does model choice influence our estimates",
    "text": "13.2 How much does model choice influence our estimates\n\npooled &lt;- modo.pool.hr5$dht$individuals$D[1:5, ]\nstrat.spec &lt;- modo.hr.region5$dht$individuals$D[1:5, ]\n\n# interleave\nlibrary(gdata)\nmerged &lt;- interleave(pooled, strat.spec)\n\nsimplename &lt;- merged\nsimplename$index &lt;- c(1,1.1, 2,2.1, 3,3.1, 4,4.1, 5,5.1)\nyrange &lt;- range(c(simplename$lcl, simplename$ucl))\nplot(simplename$index,\n     simplename$Estimate[1:10], \n     ylim=c(0, yrange[2]), xaxt=\"n\",\n     xlab=\"Location x treatment\", ylab=\"Density (per hectare)\",\n     main=\"Mourning dove estimates 2024 from covariate model\\nLeft=pooled, Right=strat-specific\")\ns &lt;- seq(1:10)\nsegments(simplename$index[s], simplename$lcl[s], simplename$index[s], simplename$ucl[s])\naxis(1, at=1:5, \n     labels=simplename$Label[seq(1, 9, by=2)],\n     cex.axis=0.9)\n\n\n\n\n\n\n\n\nThe estimates based upon a pooled detection function resemble one another; differences in detectability between strata are homogenised. Interestingly, Garden City_Rural is the stratum with fewest detections (7) and its density estimate shows the greatest sensitivity to model choice; however uncertainty in the density estimate swamps and perceived difference in density estimates. Part of the explanation for this lies in the profound variability in encounter rates between stations in Garden City_Rural.",
    "crumbs": [
      "Mourning doves üïäÔ∏è"
    ]
  },
  {
    "objectID": "about.html#content",
    "href": "about.html#content",
    "title": "What is on this website?",
    "section": "",
    "text": "Material on this website is intended to be used during the December 2024 workshop as ‚Äúcase studies‚Äù. Three researchers provided me with some of their field data and supporting information.\nI‚Äôve examined those data sets and with some back-and-forth with the researchers, have performed some distance sampling analyses. The analyses are not intended to be definitive; nor are they intended to be elegant.\nI have included essentially everything I did and presented the analysis in the order in which I conducted it. This includes blind alleys I travelled. Hopefully I have provided narrative to compliment the analyses so readers can understand the rationale for the steps and the interpretation of the findings.",
    "crumbs": [
      "What is on this website?"
    ]
  },
  {
    "objectID": "rachel/modelsel_compare.html",
    "href": "rachel/modelsel_compare.html",
    "title": "Compare density estimates; WEME detection functions and flocks vs individuals",
    "section": "",
    "text": "We found a difference of opinion regarding choice of model when using AIC and BIC. This is a decision we are to make and we wish to know the consequence of this decision upon our inference.\nI demonstrate the consequence for western meadowlark. This should also be done for the other species of interest; I expect the results to be similar.\nTable: Model criticism for WEME\n\n|Key function                                                   |Formula | C-vM p-value| $\\hat{P_a}$| se($\\hat{P_a}$)| $\\Delta$AIC|\n|:--------------------------------------------------------------|:-------|------------:|-----------:|---------------:|-----------:|\n|Hazard-rate                                                    |~1      |        0.450|       0.514|           0.017|       0.000|\n|Uniform with cosine adjustment terms of order 1,2              |NA      |        0.154|       0.479|           0.038|       5.350|\n|Half-normal with Hermite polynomial adjustment term of order 4 |~1      |        0.057|       0.458|           0.044|      11.222|\n\n\n\n\n\n\n\n\nFigure¬†1: Comparison of flock density estimates from pooled and stratum-specific detection functions.",
    "crumbs": [
      "Sandhill birds üê¶",
      "Compare density estimates; WEME detection functions\nand flocks vs individuals"
    ]
  },
  {
    "objectID": "rachel/modelsel_compare.html#adding-group-size-to-the-analysis",
    "href": "rachel/modelsel_compare.html#adding-group-size-to-the-analysis",
    "title": "Compare density estimates; WEME detection functions and flocks vs individuals",
    "section": "1 Adding group size to the analysis",
    "text": "1 Adding group size to the analysis\nIn the previous analysis, I treated all detections as detections of single individuals; ignoring that some detections were of flocks of size &gt;1. Here I repeat some of the WEME analysis incorporating group size. By simply changing the column name from Flock to size, the ds function will estimate both individuals and group densities.\n\ncolnames(alldata)[colnames(alldata) == 'Flock'] &lt;- \"size\"\ncolnames(threespec)[colnames(threespec) == 'Flock'] &lt;- \"size\"\nknitr::kable(aggregate(size~Species,data=threespec, FUN=mean), digits=4,\n             caption=\"Average flock size across all groups\")\n\n\n\nTable¬†1: Average flock size across all groups\n\n\n\n\n\n\nSpecies\nsize\n\n\n\n\nDICK\n1.0271\n\n\nGRSP\n1.0179\n\n\nWEME\n1.0302\n\n\n\n\n\n\n\n\nAverage group size is not much greater than one (Table¬†1), because detections of ‚Äúflocks‚Äù is much less common than detections of singles. Nevertheless, check for influence of group size upon detectability.\n\nwe.size &lt;- ds(data=alldata[alldata$Species==\"WEME\",], transect=\"point\",\n              key=\"hr\", truncation=170,\n              region_table = regionTable, sample_table = sampleTable,\n              convert_units = cu, formula=~size)\nwe.nosize &lt;- ds(data=alldata[alldata$Species==\"WEME\",], transect=\"point\",\n                key=\"hr\", truncation=170,\n                region_table = regionTable, sample_table = sampleTable,\n                convert_units = cu)\nknitr::kable(summarize_ds_models(we.size, we.nosize)[,3:7], digits=4,\n             caption=\"Model comparison, WEME, HR, looking for group size effect.\",\n             row.names = FALSE)\n\n\nModel comparison, WEME, HR, looking for group size effect.\n\n\nFormula\nC-vM p-value\n\\(\\hat{P_a}\\)\nse(\\(\\hat{P_a}\\))\n\\(\\Delta\\)AIC\n\n\n\n\n~1\n0.4503\n0.5141\n0.0174\n0.0000\n\n\n~size\n0.4588\n0.5142\n0.0174\n1.1615\n\n\n\n\n\nThere is no discernable effect of group size upon detectability, so we need not include that effect in subsequent detection function modelling.\nAs seen in our previous analysis and Figure¬†1, when estimating stratum-specific flock densities (treating flocks as if they were all of size 1), there was little difference in the interval estimates when using stratum-specific detection functions (as suggested by AIC) and when using a pooled detection function (as suggested by BIC). I will now contrast the stratum-specific individual densities with a pooled detection function and stratum-specific flock densities, computed earlier. This will demonstrate the adjustment from flock to individual density estimates resulting from explicit treatment of group size recorded in the data.\n\n\n\n\n\n\n\n\nFigure¬†2",
    "crumbs": [
      "Sandhill birds üê¶",
      "Compare density estimates; WEME detection functions\nand flocks vs individuals"
    ]
  },
  {
    "objectID": "rachel/modelsel_compare.html#conclusion",
    "href": "rachel/modelsel_compare.html#conclusion",
    "title": "Compare density estimates; WEME detection functions and flocks vs individuals",
    "section": "2 Conclusion",
    "text": "2 Conclusion\nAverage flock size is computed separately for each stratum. In many instances all flocks detected in a stratum were single birds. For a few strata (e.g.¬†BLA049, Figure¬†2), average flock size was &gt;1, but there is also variability in estimated flock size such that the point estimate of individual density is larger than the point estimate of flock density, but the uncertainty is also greater; hence wider confidence intervals.",
    "crumbs": [
      "Sandhill birds üê¶",
      "Compare density estimates; WEME detection functions\nand flocks vs individuals"
    ]
  }
]